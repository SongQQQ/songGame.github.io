window.__require=function e(t,a,n){function r(o,s){if(!a[o]){if(!t[o]){var c=o.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+o+"'")}}var p=a[o]={exports:{}};t[o][0].call(p.exports,function(e){return r(t[o][1][e]||e)},p,p.exports,e,t,a,n)}return a[o].exports}for(var i="function"==typeof __require&&__require,o=0;o<n.length;o++)r(n[o]);return r}({Camera:[function(e,t,a){"use strict";cc._RF.push(t,"3e30bFyIzxAWoQBfQamdHls","Camera"),Object.defineProperty(a,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.target=null,t.map=null,t.screenMiddle=null,t.boundingBox=null,t.minx=null,t.maxx=null,t.miny=null,t.maxy=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=cc.winSize;this.screenMiddle=cc.v2(e.width/2,e.height/2),this.boundingBox=cc.rect(0,0,this.map.width,this.map.height),this.minx=-(this.boundingBox.xMax-e.width),this.maxx=this.boundingBox.xMin,this.miny=-(this.boundingBox.yMax-e.height),this.maxy=this.boundingBox.yMin+100},t.prototype.start=function(){},t.prototype.update=function(e){var t=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),a=this.target.convertToWorldSpaceAR(cc.Vec2.ZERO),n=t.sub(a).add(this.screenMiddle);n.x=cc.misc.clampf(n.x,this.minx,this.maxx),n.y=cc.misc.clampf(n.y,this.miny,this.maxy),this.node.position=this.node.parent.convertToNodeSpaceAR(n)},t.prototype.test=function(){console.log("\u7ee7\u627f\u4e86\u65b9\u6cd5")},__decorate([i(cc.Node)],t.prototype,"target",void 0),__decorate([i(cc.Node)],t.prototype,"map",void 0),t=__decorate([r],t)}(cc.Component);a.default=o;var s=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.test=function(){e.prototype.test.call(this)},t}(o));s.test(),console.log("test",s.minx),cc._RF.pop()},{}],CollisderManager:[function(e,t,a){"use strict";cc._RF.push(t,"2f69e7hHFRC+oaOf8eK9Tc9","CollisderManager"),Object.defineProperty(a,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.player=null,t}return __extends(t,e),t.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0},t.prototype.start=function(){},t.prototype.update=function(e){},t.prototype.onCollisionEnter=function(e,t){},t.prototype.onCollisionStay=function(e,t){},t.prototype.onCollisionExit=function(e,t){},__decorate([i(cc.Node)],t.prototype,"player",void 0),t=__decorate([r],t)}(cc.Component);a.default=o,cc._RF.pop()},{}],DataManager:[function(e,t,a){"use strict";cc._RF.push(t,"07a22ndseRHRI4vxrnhvpUi","DataManager"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./UiManager"),r=cc._decorator,i=r.ccclass,o=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.userData=null,t.playerProperty={level:1,attack:100,power:100,cure:10,lifeValue:500,name:"\u8fde\u5929\u677e",force:0,atkType:0,baoJi:100,baoJiRatio:.2,equipArray:[0,0,0,0],equipLevelArray:[0,0,0,0]},t.hero1={level:1,attack:100,power:100,cure:10,lifeValue:500,name:"",force:0,atkType:0,baoJi:100,baoJiRatio:.2,equipArray:[0,0,0,0],equipLevelArray:[0,0,0,0]},t.hero2={level:1,attack:100,power:100,cure:10,lifeValue:500,name:"",force:0,atkType:0,baoJi:100,baoJiRatio:.2,equipArray:[0,0,0,0],equipLevelArray:[0,0,0,0]},t.heroLockArr=[],t.equipBackpackArr=[],t.itemBackpackArr=[],t.autoFightGetCoinNum=700,t.autoFightGetExpNum=90,t.coinNum=0,t.expNum=0,t.backPackCapacity=100,t.h_expBookNum=2e3,t.l_expBookNum=1e3,t.nameArr=[],t.levelNameArr=[],t.fubenProgressArr=[],t.configArr=[],t.levelLimitArr=[],t.taskId=0,t.taskArr=0,t.sexType=0,t.isWx=!1,t}var a;return __extends(t,e),a=t,t.getInstance=function(){return a.instance},t.prototype.onLoad=function(){a.instance=this,this.initData(),this.initGame(),this.reportData(101)},t.prototype.initGame=function(){this.isWx||(this.userData=JSON.parse(cc.sys.localStorage.getItem("config")),this.playerProperty=this.userData.json.playerProperty,this.hero1=this.userData.json.hero1,this.hero2=this.userData.json.hero2,this.heroLockArr=this.userData.json.heroLockArr,this.equipBackpackArr=this.userData.json.equipBackpackArr,this.itemBackpackArr=this.userData.json.itemBackpackArr,this.coinNum=this.userData.json.coinNum,this.expNum=this.userData.json.expNum,this.fubenProgressArr=this.userData.json.fubenProgressArr,this.taskId=this.userData.json.taskId,this.sexType=this.userData.json.sexType,null!=this.userData.json.currentTask?this.currentTask=this.userData.json.currentTask:this.currentTask=this.taskArr[0])},t.prototype.initData=function(){this.levelLimitArr=[5,10,15,20,25,40,50,70,90,120],this.taskArr=this.node.getComponent("TaskList").taskArr,this.nameArr=["\u7518\u5b81","\u53f8\u9a6c\u61ff","\u8340\u6538","\u8d3e\u8be9","\u8bf8\u845b\u4eae","\u5f20\u8fbd","\u5f90\u76db","\u66f9\u64cd","\u8346\u5dde\u5c0f\u5175","\u5b59\u5c1a\u9999","\u9646\u900a"],this.levelNameArr=["\u8fc7\u6cb3\u62c6\u68651-1","\u8fc7\u6cb3\u62c6\u68651-2","\u8fc7\u6cb3\u62c6\u68651-3","\u5947\u7b56\u5341\u4e8c1-1","\u5947\u7b56\u5341\u4e8c1-2","\u5947\u7b56\u5341\u4e8c1-3","\u70c8\u706b\u711a\u57ce1-1","\u70c8\u706b\u711a\u57ce1-2","\u70c8\u706b\u711a\u57ce1-3","\u4e71\u4e16\u67ad\u96c41-1","\u4e71\u4e16\u67ad\u96c41-2","\u4e71\u4e16\u67ad\u96c41-3"],this.configArr=[{atkType:0,atkNum:200,hp:500},{atkType:1,atkNum:220,hp:700},{atkType:0,atkNum:230,hp:800},{atkType:1,atkNum:300,hp:1e3},{atkType:0,atkNum:400,hp:1200},{atkType:1,atkNum:420,hp:1400},{atkType:0,atkNum:450,hp:1600},{atkType:0,atkNum:600,hp:3e3},{atkType:1,atkNum:100,hp:500},{atkType:0,atkNum:100,hp:500},{atkType:1,atkNum:100,hp:500}]},t.prototype.getMonsterProperty=function(e,t){switch(t){case 1:return 15*e;case 2:return 80*e;case 3:return 80*e+Math.floor(20*Math.random());case 4:return 60*e+Math.floor(10*Math.random())}},t.prototype.getPlayerLevelFromExp=function(e){return Math.ceil((-17+Math.sqrt(289+12*e/5))/6)},t.prototype.saveDataToLocal=function(e){switch(e){case 1:0==n.default.getInstance().currentHeroId?this.userData.json.playerProperty=n.default.getInstance().currentHeroProperty:1==n.default.getInstance().currentHeroId?this.userData.json.hero1=n.default.getInstance().currentHeroProperty:2==n.default.getInstance().currentHeroId&&(this.userData.json.hero2=n.default.getInstance().currentHeroProperty);break;case 2:this.userData.json.heroLockArr=n.default.getInstance().currentHeroLockArr,this.userData.json.fubenProgressArr=n.default.getInstance().currentFbProgressArr,this.userData.json.taskId=n.default.getInstance().currentTaskId,this.userData.json.currentTask=n.default.getInstance().currentTask;break;case 3:this.userData.json.equipBackpackArr=n.default.getInstance().currentBpEquipArr,this.userData.json.itemBackpackArr=n.default.getInstance().currentBpItemArr;break;case 4:this.userData.json.coinNum=n.default.getInstance().currentCoinNum,this.userData.json.expNum=n.default.getInstance().currentExpNum}JSON.parse(cc.sys.localStorage.getItem("config"))!=this.userData?cc.sys.localStorage.setItem("config",JSON.stringify(this.userData)):console.log("\u65e0\u6570\u636e\u6539\u53d8")},t.prototype.getEqipNameFromId=function(e,t,a){switch(e){case 0:switch(t){case 0:return"\u6b66\u5668";case 1:return 100*a+Math.floor(10*Math.random());case 2:return 20*a+Math.floor(5*Math.random());case 3:return 150*a;case 4:return"\u653b\u51fb\u529b"}case 1:switch(t){case 0:return"\u5934\u76d4";case 1:return 110*a+Math.floor(10*Math.random());case 2:return 18*a+Math.floor(5*Math.random());case 3:return 180*a;case 4:return"\u9632\u5fa1\u529b"}case 2:switch(t){case 0:return"\u94e0\u7532";case 1:return 80*a+Math.floor(10*Math.random());case 2:return 20*a+Math.floor(5*Math.random());case 3:return 120*a;case 4:return"\u56de\u590d\u529b"}case 3:switch(t){case 0:return"\u978b\u5b50";case 1:return 90*a+Math.floor(10*Math.random());case 2:return 28*a+Math.floor(5*Math.random());case 3:return 115*a;case 4:return"\u6cbb\u6108\u529b"}}},t.prototype.getItemName=function(e){switch(e){case 0:return"\u9ad8\u7ea7\u7ecf\u9a8c\u4e66";case 1:return"\u521d\u7ea7\u7ecf\u9a8c\u4e66";case 2:return"\u788e\u7247\u793c\u76d2";case 3:return"\u88c5\u5907\u953b\u9020\u77f3";case 4:return"\u5b59\u5c1a\u9999\u788e\u7247";case 5:return"\u9646\u900a\u788e\u7247";case 6:return"\u5f20\u8fbd\u788e\u7247";case 7:return"\u5415\u5e03\u788e\u7247"}},t.prototype.getHeroSyntheicNum=function(e){switch(e){case 4:return 20;case 5:return 50;case 6:return 80;case 7:return 120}},t.prototype.bossConfig=function(e){switch(e){case 1:return[0];case 2:return[1,8];case 3:return[2,8,8];case 4:return[3,8,8,8];case 5:return[4,8,8,8,8];case 6:return[5,8,8,8,8,8];case 7:return[6,8,8,8,8,8,8];case 8:return[7,8,8,8,8,8,8]}},t.prototype.transcriptConfig=function(e){switch(e){case 1:return[4,8,8,8,8,8];case 2:return[3,1,2,8,8,8];case 3:return[6,3,2,8,8,8];case 4:return[9,6,7,8,8,8]}},t.prototype.minJiangtranscriptConfig=function(e){switch(e){case 1:return[0];case 2:return[0,8];case 3:return[0,8,8,8];case 4:return[2];case 5:return[2,8];case 6:return[2,8,8,8];case 7:return[3];case 8:return[3,8];case 9:return[3,8,8,8];case 10:return[7];case 11:return[7,8];case 12:return[7,8,8,8]}},t.prototype.getEnemyInfo=function(e){switch(e){case 0:return"\u7518\u5b81";case 1:return"\u53f8\u9a6c\u61ff";case 2:return"\u8340\u6538";case 3:return"\u8d3e\u8be9";case 4:return"\u8bf8\u845b\u4eae";case 5:return"\u5f20\u8fbd";case 6:return"\u5f90\u76db";case 7:return"\u66f9\u64cd";case 8:return"\u8346\u5dde\u5c0f\u5175";case 9:return"\u5b59\u5c1a\u9999"}},t.prototype.numToString=function(e){var t,a;return e<1e4?(a=""==(a=(t=Math.floor(10*e+.5)+"").slice(0,-1))?"0":a)+"."+t.slice(-1):e<1e8?(a=""==(a=(t=Math.floor(e/1e3+.5)+"").slice(0,-1))?"0":a)+"."+t.slice(-1)+"\u4e07":void 0},t.prototype.reportData=function(e){var t={event:e},a=JSON.stringify(t);if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",a)},t.instance=null,__decorate([o(cc.Label)],t.prototype,"label",void 0),t=a=__decorate([i],t)}(cc.Component);a.default=s,cc._RF.pop()},{"./UiManager":"UiManager"}],GameManager:[function(e,t,a){"use strict";cc._RF.push(t,"a01cdb1a1lJNpIbX19PwZrQ","GameManager"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./UiManager"),r=e("./DataManager"),i=cc._decorator,o=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.equipmentPrefab=null,t.equipmentPool=null,t.effectPrefabArray=[],t.effectPoolArray=[],t.bossImgArr=[],t.bossPanel=null,t.playerCamp=null,t.enemyCamp=null,t.tempCamp=null,t.tempNode=null,t.effectParent=null,t.bossLevelId=1,t.transcriptLevelId=1,t.minjiangFuBenId=1,t.fightModel=0,t.tempPlayerArr=[],t.tempEnemyArr=[],t.tempHeroIndex=0,t.tempEnemyIndex=0,t.moveSpeed=50,t.waitTime=.8,t.isSkip=!1,t.currentIndex=0,t.heroImgIsScroll=!1,t.isResetOver=!0,t.monsterIndex=1,t}var a;return __extends(t,e),a=t,t.getInstance=function(){return a.instance},t.prototype.onLoad=function(){a.instance=this,cc.game.setFrameRate(30),this.initGame()},t.prototype.initGame=function(){this.initPool(),this.playerCamp=this.bossPanel.getChildByName("playerCamp"),this.enemyCamp=this.bossPanel.getChildByName("enemyCamp"),this.tempCamp=this.bossPanel.getChildByName("tempCamp"),this.tempNode=this.bossPanel.getChildByName("tempNode"),this.effectParent=this.bossPanel.getChildByName("effectParent"),this.emptyBossScene()},t.prototype.initPool=function(){this.equipmentPool=new cc.NodePool;for(var e=0;e<2;e++)this.equipmentPool.put(cc.instantiate(this.equipmentPrefab));for(e=0;e<this.effectPrefabArray.length;e++)this.effectPoolArray[e]=new cc.NodePool;for(e=0;e<this.effectPrefabArray.length;e++)this.effectPoolArray[e].put(cc.instantiate(this.effectPrefabArray[e]))},t.prototype.getDegree=function(e,t){var a=t.x-e.x,n=t.y-e.y,r=180*Math.atan(a/n)/Math.PI;return n<0&&(r=a<0?180+Math.abs(r):180-Math.abs(r)),r},t.prototype.getDistance=function(e,t){var a=e.x-t.x,n=e.y-t.y;return Math.sqrt(a*a+n*n)},t.prototype.destroyNode=function(e,t){t.put(e)},t.prototype.getEquipment=function(e){for(var t=0;t<e;t++){if(n.default.getInstance().currentBpEquipArr.length>=r.default.getInstance().backPackCapacity)return void n.default.getInstance().commonTipsPop("\u80cc\u5305\u5df2\u6ee1");if(this.equipmentPool.size()>0)var a=this.equipmentPool.get();else a=cc.instantiate(this.equipmentPrefab);a.parent=n.default.getInstance().equipmentGrid;var i=Math.floor(4*Math.random());a.getChildByName("img").getComponent(cc.Sprite).spriteFrame=n.default.getInstance().equipImgArr[i];var o=r.default.getInstance().getEqipNameFromId(i,0,0);a.getChildByName("name").getComponent(cc.Label).string=o+"",this.getItemTips(o,1),a.name=i.toString(),n.default.getInstance().currentBpEquipArr.push(i),n.default.getInstance().backpackPanel.getChildByName("backPackCapacity").children[1].getComponent(cc.Label).string=n.default.getInstance().currentBpEquipArr.length+"/"+r.default.getInstance().backPackCapacity}r.default.getInstance().saveDataToLocal(3)},t.prototype.getItemTips=function(e,t){var a=this;if(n.default.getInstance().itemTipsPool.size()>0)var r=n.default.getInstance().itemTipsPool.get();else r=cc.instantiate(n.default.getInstance().itemTipsPrefab);r.parent=n.default.getInstance().node.getChildByName("tipsParent").getChildByName("itemTipsParent"),r.position=cc.v2(0,219),r.opacity=255,r.children[0].getComponent(cc.RichText).string="<>"+e+"</c><color=#0fffff>*"+t+"</color>";var i=cc.fadeOut(2),o=cc.callFunc(function(){a.destroyNode(r,n.default.getInstance().itemTipsPool)},this);r.runAction(cc.sequence(i,o))},t.prototype.initBossScene=function(){var e;0==this.fightModel?e=r.default.getInstance().bossConfig(this.bossLevelId):1==this.fightModel?e=r.default.getInstance().transcriptConfig(this.transcriptLevelId):2==this.fightModel&&(e=r.default.getInstance().minJiangtranscriptConfig(this.minjiangFuBenId));for(var t=e.length,a=this.enemyCamp.childrenCount,i=0;i<a;i++)i<t&&(this.enemyCamp.children[i].active=!0,this.tempEnemyArr.push(this.enemyCamp.children[i]),this.enemyCamp.children[i].getComponent("Hero").type=e[i],this.enemyCamp.children[i].getComponent("Hero").initEnemyProperty());this.playerCamp.children[0].active=!0,this.playerCamp.children[0].getChildByName("name").getComponent(cc.Label).string=n.default.getInstance().currentPlayerProperty.name,this.playerCamp.children[0].getComponent("Hero").initHeroProperty(0),this.tempPlayerArr.push(this.playerCamp.children[0]);for(i=0;i<2;i++)0!=n.default.getInstance().currentHeroLockArr[i]&&(this.playerCamp.children[i+1].active=!0,this.playerCamp.children[i+1].getComponent("Hero").initHeroProperty(i+1),this.tempPlayerArr.push(this.playerCamp.children[i+1]))},t.prototype.emptyBossScene=function(){for(var e=this.playerCamp.childrenCount,t=this.enemyCamp.childrenCount,a=0;a<e;a++)this.playerCamp.children[a].active=!1;for(a=0;a<t;a++)this.enemyCamp.children[a].active=!1},t.prototype.enterFightingScene=function(){this.isResetOver=!1,this.emptyBossScene(),this.sortChildNode(this.playerCamp),this.sortChildNode(this.enemyCamp),this.bossPanel.active=!0,this.bossPanel.getChildByName("bossAni").active=!0,this.bossPanel.getChildByName("bossAni").getComponent(cc.Animation).play(),this.scheduleOnce(this.prepareScene,2)},t.prototype.prepareScene=function(){this.initBossScene(),this.isSkip=!1,this.heroFighting()},t.prototype.heroFighting=function(){var e=this;if(!this.isSkip)if(this.tempPlayerArr.length<=0)n.default.getInstance().failedGame();else{var t;this.tempHeroIndex>=this.tempPlayerArr.length&&(this.tempHeroIndex=0);var i=this.tempPlayerArr[this.tempHeroIndex],o=i.position,s=i.getChildByName("name").getComponent(cc.Label).string;t=s==n.default.getInstance().currentPlayerProperty.name?n.default.getInstance().currentPlayerProperty.atkType:r.default.getInstance().configArr[r.default.getInstance().nameArr.indexOf(s)].atkType;var c=this.getRandomTarget(this.tempEnemyArr);if(c.parent=this.tempCamp,i.parent=this.tempCamp,0==t){var l=cc.v2(c.x+20,c.y-100),p=a.getInstance().getDistance(i.position,c.position)/(50*this.moveSpeed),h=cc.moveTo(p,l);i.runAction(cc.sequence(h,cc.callFunc(function(){var e=this;this.effectPlay(c,2),i.getChildByName("img").getComponent(cc.Animation).play("hit1"),c.getChildByName("img").getComponent(cc.Animation).play("attaked1"),this.hitTextAni(i,c),this.scheduleOnce(function(){i.parent=e.playerCamp,c.parent=e.enemyCamp,i.position=o,e.enemyFighting()},this.waitTime)},this)))}else this.effectPlay(i,0),this.effectPlay(c,1),i.getChildByName("img").getComponent(cc.Animation).play("hit"),c.getChildByName("img").getComponent(cc.Animation).play("attaked1"),this.scheduleOnce(function(){i.parent=e.playerCamp,c.parent=e.enemyCamp,e.enemyFighting()},this.waitTime),this.hitTextAni(i,c);this.tempHeroIndex+=1}},t.prototype.hitTextAni=function(e,t){var a=e.getComponent("Hero").atkNum;t.getComponent("Hero").underAttack(a),t.getChildByName("atkNum").getComponent(cc.Label).string=a,t.getChildByName("atkNum").getComponent(cc.Animation).play()},t.prototype.enemyFighting=function(){var e=this;if(!this.isSkip)if(this.tempEnemyArr.length<=0)n.default.getInstance().winGame();else{var t;this.tempEnemyIndex>=this.tempEnemyArr.length&&(this.tempEnemyIndex=0);var i=this.tempEnemyArr[this.tempEnemyIndex],o=i.position,s=i.getChildByName("name").getComponent(cc.Label).string;t=r.default.getInstance().configArr[r.default.getInstance().nameArr.indexOf(s)].atkType;var c=this.getRandomTarget(this.tempPlayerArr);if(i.parent=this.tempCamp,c.parent=this.tempCamp,0==t){var l=cc.v2(c.x-20,c.y+100),p=a.getInstance().getDistance(c.position,i.position)/(50*this.moveSpeed),h=cc.moveTo(p,l);i.runAction(cc.sequence(h,cc.callFunc(function(){var e=this;this.effectPlay(c,3),i.getChildByName("img").getComponent(cc.Animation).play("hit2"),c.getChildByName("img").getComponent(cc.Animation).play("attaked"),this.hitTextAni(i,c),this.scheduleOnce(function(){c.parent=e.playerCamp,i.parent=e.enemyCamp,i.position=o,e.heroFighting()},this.waitTime)},this)))}else this.effectPlay(i,0),this.effectPlay(c,1),i.getChildByName("img").getComponent(cc.Animation).play("hit"),c.getChildByName("img").getComponent(cc.Animation).play("attaked"),this.scheduleOnce(function(){c.parent=e.playerCamp,i.parent=e.enemyCamp,e.heroFighting()},this.waitTime),this.hitTextAni(i,c);this.tempEnemyIndex+=1}},t.prototype.getRandomTarget=function(e){var t=e.length,a=Math.floor(Math.random()*t);return this.currentIndex=a,e[a]},t.prototype.getEffectType=function(e){if(this.effectPoolArray[e].size()>0)var t=this.effectPoolArray[e].get();else t=cc.instantiate(this.effectPrefabArray[e]);return t},t.prototype.effectPlay=function(e,t){var a=this,n=this.getEffectType(t);n.parent=this.effectParent,n.position=cc.v2(e.position.x,e.position.y),n.getComponent(cc.Animation).play(),this.scheduleOnce(function(){a.destroyNode(n,a.effectPoolArray[t])},2)},t.prototype.skipBtnClick=function(){var e=this;if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":132}');this.unschedule(this.prepareScene),this.isSkip=!0,this.resetTempArr(),this.bossPanel.active=!1,this.scheduleOnce(function(){e.isResetOver=!0},3.5)},t.prototype.resetTempArr=function(){this.tempEnemyIndex=0,this.tempHeroIndex=0,this.tempPlayerArr=[],this.tempEnemyArr=[]},t.prototype.sortChildNode=function(e){for(var t=e.childrenCount,a=0;a<t;a++)e.children[0].parent=this.tempNode;for(a=0;a<t;a++)for(var n=0;n<this.tempNode.childrenCount;n++){var r=this.tempNode.children[n].name,i=r.substr(r.length-1,1);parseInt(i)-1==a&&(this.tempNode.children[n].parent=e)}},t.prototype.judgeArrIsEmpty=function(e){for(var t=!1,a=0;a<e.length;a++){if("null"!=e[a])return t=!1;t=!0}return t},t.prototype.twoDoubleBtnClick=function(){this.changeAnistateSpeed(1),this.bossPanel.getChildByName("btnSpeed").children[0].active=!0,this.bossPanel.getChildByName("btnSpeed").children[1].active=!1},t.prototype.oneDoubleBtnClick=function(){this.changeAnistateSpeed(2),this.bossPanel.getChildByName("btnSpeed").children[0].active=!1,this.bossPanel.getChildByName("btnSpeed").children[1].active=!0},t.prototype.changeAnistateSpeed=function(e){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":133}');var t;t=["hit","hit1","hit2","attaked","attaked1"];for(var a=0;a<5;a++){var n=t[a];this.playerCamp.children[0].getChildByName("img").getComponent(cc.Animation).getAnimationState(n).speed=7}this.waitTime=.8/e,this.moveSpeed=50*e},t.instance=null,__decorate([s(cc.Prefab)],t.prototype,"equipmentPrefab",void 0),__decorate([s(cc.Prefab)],t.prototype,"effectPrefabArray",void 0),__decorate([s(cc.SpriteFrame)],t.prototype,"bossImgArr",void 0),__decorate([s(cc.Node)],t.prototype,"bossPanel",void 0),t=a=__decorate([o],t)}(cc.Component);a.default=c,cc._RF.pop()},{"./DataManager":"DataManager","./UiManager":"UiManager"}],Hero:[function(e,t,a){"use strict";cc._RF.push(t,"9d434fDN8tLEbH1t0JMHgZ+","Hero"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./DataManager"),r=e("./UiManager"),i=e("./GameManager"),o=cc._decorator,s=o.ccclass,c=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.atkNum=0,t.hp=0,t.type=-1,t.startHp=0,t}return __extends(t,e),t.prototype.initEnemyProperty=function(){this.atkNum=n.default.getInstance().configArr[this.type].atkNum,this.hp=n.default.getInstance().configArr[this.type].hp,this.node.getChildByName("img").getComponent(cc.Sprite).spriteFrame=i.default.getInstance().bossImgArr[this.type],this.node.getChildByName("name").getComponent(cc.Label).string=n.default.getInstance().getEnemyInfo(this.type),this.node.getChildByName("progress").getComponent(cc.Sprite).fillRange=1,this.node.getChildByName("atkNum").opacity=0,this.node.getChildByName("atkNum").getComponent(cc.Animation).stop(),this.node.getChildByName("img").getComponent(cc.Animation).stop(),this.startHp=this.hp},t.prototype.initHeroProperty=function(e){switch(e){case 0:this.atkNum=r.default.getInstance().currentPlayerProperty.attack,this.hp=r.default.getInstance().currentPlayerProperty.lifeValue;break;case 1:this.atkNum=r.default.getInstance().hero1.attack,this.hp=r.default.getInstance().hero1.lifeValue;break;case 2:this.atkNum=r.default.getInstance().hero2.attack,this.hp=r.default.getInstance().hero2.lifeValue}this.startHp=this.hp,this.node.getChildByName("progress").getComponent(cc.Sprite).fillRange=1,this.node.getChildByName("atkNum").opacity=0,this.node.getChildByName("atkNum").getComponent(cc.Animation).stop(),this.node.getChildByName("img").getComponent(cc.Animation).stop()},t.prototype.underAttack=function(e){if(this.hp-e<0){var t=this.node.name,a=t.substr(t.length-1,1);parseInt(a);this.type>=0?i.default.getInstance().tempEnemyArr.length<=0||i.default.getInstance().tempEnemyArr.splice(i.default.getInstance().currentIndex,1):i.default.getInstance().tempPlayerArr.length<=0||i.default.getInstance().tempPlayerArr.splice(i.default.getInstance().currentIndex,1),this.node.active=!1}else this.hp-=e,this.node.getChildByName("progress").getComponent(cc.Sprite).fillRange=this.hp/this.startHp},t=__decorate([s],t)}(cc.Component));a.default=c,cc._RF.pop()},{"./DataManager":"DataManager","./GameManager":"GameManager","./UiManager":"UiManager"}],MapScroll:[function(e,t,a){"use strict";cc._RF.push(t,"3d899/JEUdD6bMMGzPIxOu8","MapScroll"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./GameManager"),r=cc._decorator,i=r.ccclass,o=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.backgroundNode=[],t.mapScrollSpeed=1.2,t}var a;return __extends(t,e),a=t,t.getInstance=function(){return a.instance},t.prototype.onLoad=function(){a.instance=this},t.prototype.bgScroll=function(){this.backgroundNode[0].x-=this.mapScrollSpeed/2,this.backgroundNode[1].x-=this.mapScrollSpeed/2,this.backgroundNode[0].x<-2555&&(this.backgroundNode[0].x=this.backgroundNode[1].x+2250),this.backgroundNode[1].x<-2555&&(this.backgroundNode[1].x=this.backgroundNode[0].x+2250)},t.prototype.update=function(e){n.default.getInstance().heroImgIsScroll&&this.bgScroll()},t.instance=null,__decorate([o(cc.Node)],t.prototype,"backgroundNode",void 0),t=a=__decorate([i],t)}(cc.Component);a.default=s,cc._RF.pop()},{"./GameManager":"GameManager"}],MonsterManager:[function(e,t,a){"use strict";cc._RF.push(t,"9c8e3540nhCQ51foWximuzk","MonsterManager"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./GameManager"),r=cc._decorator,i=r.ccclass,o=r.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.roundMonsterPreArray=[],t.roundMonsterPool=[],t.playerAIPreArray=[],t.playerAIPool=[],t.dieEffectPrefab=null,t.dieEffectPool=null,t.skillEffectPrefab=null,t.skillEffectPool=null,t.aiTitleImg=[],t.effectParent=null,t.maxPos_x=944,t.maxPos_y=995,t.minPos_x=462,t.minPos_y=270,t.monsterNum=6,t.playerAINum=2,t.tempMonsterArr=[],t.monsterIndex=0,t}var a;return __extends(t,e),a=t,t.getInstance=function(){return a.instance},t.prototype.onLoad=function(){a.instance=this;for(var e=0;e<this.roundMonsterPreArray.length;e++)this.roundMonsterPool[e]=new cc.NodePool;for(var t=0;t<this.roundMonsterPreArray.length;t++)for(var n=0;n<2;n++)this.roundMonsterPool[t].put(cc.instantiate(this.roundMonsterPreArray[t]));for(var r=0;r<this.playerAIPreArray.length;r++)this.playerAIPool[r]=new cc.NodePool;for(var i=0;i<this.playerAIPreArray.length;i++)for(n=0;n<2;n++)this.playerAIPool[i].put(cc.instantiate(this.playerAIPreArray[i]));this.dieEffectPool=new cc.NodePool,this.skillEffectPool=new cc.NodePool;for(var o=0;o<3;o++)this.dieEffectPool.put(cc.instantiate(this.dieEffectPrefab)),this.skillEffectPool.put(cc.instantiate(this.skillEffectPrefab))},t.prototype.start=function(){for(var e=0;e<this.monsterNum;e++)this.createRoundMonster();for(e=0;e<this.playerAINum;e++)this.createPlayerAI()},t.prototype.createRoundMonster=function(){var e=n.default.getInstance().monsterIndex;if(this.roundMonsterPool[e-1].size()>0)var t=this.roundMonsterPool[e-1].get();else t=cc.instantiate(this.roundMonsterPreArray[e-1]);var a=Math.random()*(this.maxPos_y-this.minPos_y)+this.minPos_y,r=Math.random()*(this.maxPos_x-this.minPos_x)+this.minPos_x;t.parent=this.node,t.position=cc.v2(r,a),t.children[0].getComponent("Monster").initMonster(e)},t.prototype.createPlayerAI=function(){var e=Math.floor(2*Math.random())+1;if(this.playerAIPool[e-1].size()>0)var t=this.playerAIPool[e-1].get();else t=cc.instantiate(this.playerAIPreArray[e-1]);var a=Math.random()*(this.maxPos_y-this.minPos_y)+this.minPos_y,n=Math.random()*(this.maxPos_x-this.minPos_x)+this.minPos_x;t.parent=this.node.parent.getChildByName("playerAiParent"),t.position=cc.v2(n,a),t.children[0].getComponent("PlayerAi").type=e-1,t.children[0].getComponent("PlayerAi").initPlayerAI()},t.prototype.replaceMonster=function(){if(this.monsterIndex>=2){for(var e=this.node.childrenCount,t=0;t<e;t++)this.node.children[0].children[0].getComponent("Monster").monsterDie();n.default.getInstance().monsterIndex=2;for(t=0;t<e;t++)this.createRoundMonster();this.monsterIndex=0}},t.instance=null,__decorate([o(cc.Prefab)],t.prototype,"roundMonsterPreArray",void 0),__decorate([o(cc.Prefab)],t.prototype,"playerAIPreArray",void 0),__decorate([o(cc.Prefab)],t.prototype,"dieEffectPrefab",void 0),__decorate([o(cc.Prefab)],t.prototype,"skillEffectPrefab",void 0),__decorate([o(cc.SpriteFrame)],t.prototype,"aiTitleImg",void 0),__decorate([o(cc.Node)],t.prototype,"effectParent",void 0),t=a=__decorate([i],t)}(cc.Component);a.default=s,cc._RF.pop()},{"./GameManager":"GameManager"}],Monster:[function(e,t,a){"use strict";cc._RF.push(t,"24c63OM6yZF5LDfzydCC1Hr","Monster"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./MonsterManager"),r=e("./GameManager"),i=e("./Player"),o=cc._decorator,s=o.ccclass,c=(o.property,cc.Enum({idle:0,front_L:1,front_R:2,behind_L:3,behind_R:4})),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stopTime=10,t.moveTime=15,t.speedX=1,t.speedY=1,t.timeCounter1=0,t.timeCounter2=0,t.monster_state=c.idle,t.lastTime_state=c.idle,t.animationName=null,t.atkAniName=null,t.isAtk=!1,t.monsterSpeed=2,t.monsterType=0,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.initMonster=function(e){this.stopTime=10,this.moveTime=15,this.speedX=1,this.speedY=1,this.timeCounter1=0,this.timeCounter2=0,this.monster_state=c.idle,this.lastTime_state=c.idle,this.animationName=null,this.atkAniName=null,this.isAtk=!1,this.monsterSpeed=2,this.monsterType=e,this.node.active=!0,this.change()},t.prototype.update=function(e){if(!this.isAtk){if(this.timeCounter1+=e,this.timeCounter1<this.moveTime){this.lastTime_state=this.monster_state;var t=r.default.getInstance().getDegree(cc.v2(0,0),cc.v2(this.speedX,this.speedY));this.getClickAngle(t),this.getAnimationName();var a=this.node.getComponent(cc.Animation).getAnimationState(this.atkAniName).isPlaying;(this.lastTime_state!=this.monster_state||a)&&this.node.getComponent(cc.Animation).play(this.animationName),this.node.parent.x+=this.speedX,this.node.parent.y+=this.speedY}else{var n=this.node.getComponent(cc.Animation).getAnimationState(this.atkAniName);null==n||n.isPlaying||this.node.getComponent(cc.Animation).play(this.atkAniName),this.timeCounter2+=e,this.timeCounter2>this.stopTime&&(this.change(),this.timeCounter1=0,this.timeCounter2=0,this.lastTime_state=c.idle)}this.check(),this.checkDisWithPlayer()}},t.prototype.change=function(){this.stopTime=1*Math.random()+1,this.moveTime=5*Math.random()+8,this.speedX=1*Math.random()+1,this.speedY=1*Math.random()+1},t.prototype.check=function(){this.node.parent.x>n.default.getInstance().maxPos_x&&(this.speedX=-this.speedX,this.node.parent.x=n.default.getInstance().maxPos_x),this.node.parent.x<n.default.getInstance().minPos_x&&(this.speedX=-this.speedX,this.node.parent.x=n.default.getInstance().minPos_x),this.node.parent.y>n.default.getInstance().maxPos_y&&(this.speedY=-this.speedY,this.node.parent.y=n.default.getInstance().maxPos_y),this.node.parent.y<n.default.getInstance().minPos_y&&(this.speedY=-this.speedY,this.node.parent.y=n.default.getInstance().minPos_y)},t.prototype.getClickAngle=function(e){e>=-90&&e<0?this.monster_state=c.behind_L:e>=0&&e<90?this.monster_state=c.behind_R:e>=90&&e<180?this.monster_state=c.front_R:e>=180&&e<270&&(this.monster_state=c.front_L)},t.prototype.getAnimationName=function(){switch(this.monster_state){case 1:this.animationName="run1_"+this.monsterType,this.atkAniName="atk1_"+this.monsterType,this.node.scaleX=-1;break;case 2:this.animationName="run1_"+this.monsterType,this.atkAniName="atk1_"+this.monsterType,this.node.scaleX=1;break;case 3:this.animationName="run2_"+this.monsterType,this.atkAniName="atk2_"+this.monsterType,this.node.scaleX=-1;break;case 4:this.animationName="run2_"+this.monsterType,this.atkAniName="atk2_"+this.monsterType,this.node.scaleX=1}},t.prototype.checkDisWithPlayer=function(){var e=this;if(i.default.getInstance().isAtk){var t=i.default.getInstance().maxDistance,a=i.default.getInstance();if(r.default.getInstance().getDistance(a.node.parent,this.node.parent)<t){var o=i.default.getInstance().getNearestNode(this.node.parent);if(null!=o){this.isAtk=!0,n.default.getInstance().tempMonsterArr.length<8&&n.default.getInstance().tempMonsterArr.push(e.node.parent);var s=r.default.getInstance().getDistance(o,this.node.parent),c=r.default.getInstance().getDegree(this.node.parent,o);this.getClickAngle(c),this.getAnimationName(),this.node.getComponent(cc.Animation).play(this.animationName);var l=s/(50*this.monsterSpeed),p=cc.moveTo(l,o);this.node.parent.runAction(cc.sequence(p,cc.callFunc(function(){var t=r.default.getInstance().getDegree(e.node.parent,i.default.getInstance().node.parent);e.getClickAngle(t),e.getAnimationName(),e.node.getComponent(cc.Animation).play(e.atkAniName)})))}}}},t.prototype.monsterAtkNum=function(){var e=this.node.parent.getChildByName("atkNum");e.getComponent(cc.Label).string=Math.floor(1e3*Math.random())+9e3+"",e.getComponent(cc.Animation).play()},t.prototype.monsterDie=function(){r.default.getInstance().destroyNode(this.node.parent,n.default.getInstance().roundMonsterPool[this.monsterType-1])},t=__decorate([s],t)}(cc.Component);a.default=l,cc._RF.pop()},{"./GameManager":"GameManager","./MonsterManager":"MonsterManager","./Player":"Player"}],PlayerAi:[function(e,t,a){"use strict";cc._RF.push(t,"c16c0BwOuNOP7hAM0H3rlLu","PlayerAi"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./MonsterManager"),r=e("./GameManager"),i=e("./DataManager"),o=cc._decorator,s=o.ccclass,c=(o.property,cc.Enum({idle:0,front_L:1,front_R:2,behind_L:3,behind_R:4})),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stopTime=10,t.moveTime=15,t.speedX=1,t.speedY=1,t.timeCounter1=0,t.timeCounter2=0,t.playerAI_state=c.idle,t.lastTime_state=c.idle,t.animationName=null,t.atkAniName=null,t.isAtk=!1,t.playerAISpeed=2,t.type=0,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.initPlayerAI=function(){this.stopTime=10,this.moveTime=15,this.speedX=1,this.speedY=1,this.timeCounter1=0,this.timeCounter2=0,this.playerAI_state=c.idle,this.lastTime_state=c.idle,this.animationName=null,this.atkAniName=null,this.isAtk=!1,this.playerAISpeed=2,this.change(),this.randomImgAndName()},t.prototype.update=function(e){if(!this.isAtk){if(this.timeCounter1+=e,this.timeCounter1<this.moveTime){this.lastTime_state=this.playerAI_state;var t=r.default.getInstance().getDegree(cc.v2(0,0),cc.v2(this.speedX,this.speedY));this.getClickAngle(t),this.getAnimationName();var a=this.node.getComponent(cc.Animation).getAnimationState(this.atkAniName).isPlaying;(this.lastTime_state!=this.playerAI_state||a)&&this.node.getComponent(cc.Animation).play(this.animationName),this.node.parent.x+=this.speedX,this.node.parent.y+=this.speedY}else{this.node.getComponent(cc.Animation).getAnimationState(this.atkAniName).isPlaying||this.node.getComponent(cc.Animation).play(this.atkAniName),this.timeCounter2+=e,this.timeCounter2>this.stopTime&&(this.change(),this.timeCounter1=0,this.timeCounter2=0,this.lastTime_state=c.idle)}this.check()}},t.prototype.change=function(){this.stopTime=1*Math.random()+1.3,this.moveTime=5*Math.random()+5,this.speedX=1*Math.random()+1,this.speedY=1*Math.random()+1},t.prototype.check=function(){var e=!1;this.node.parent.x>n.default.getInstance().maxPos_x&&(this.speedX=-this.speedX,this.node.parent.x=n.default.getInstance().maxPos_x),this.node.parent.x<n.default.getInstance().minPos_x&&(this.speedX=-this.speedX,this.node.parent.x=n.default.getInstance().minPos_x),this.node.parent.y>n.default.getInstance().maxPos_y&&(this.speedY=-this.speedY,this.node.parent.y=n.default.getInstance().maxPos_y),this.node.parent.y<n.default.getInstance().minPos_y&&(this.speedY=-this.speedY,this.node.parent.y=n.default.getInstance().minPos_y,e=!0),e&&(r.default.getInstance().destroyNode(this.node.parent,n.default.getInstance().playerAIPool[this.type]),n.default.getInstance().createPlayerAI())},t.prototype.getClickAngle=function(e){e>=-90&&e<0?this.playerAI_state=c.behind_L:e>=0&&e<90?this.playerAI_state=c.behind_R:e>=90&&e<180?this.playerAI_state=c.front_R:e>=180&&e<270&&(this.playerAI_state=c.front_L)},t.prototype.getAnimationName=function(){switch(this.playerAI_state){case 1:this.animationName="run1",this.atkAniName="atk1",this.node.scaleX=-1;break;case 2:this.animationName="run1",this.atkAniName="atk1",this.node.scaleX=1;break;case 3:this.animationName="run2",this.atkAniName="atk2",this.node.scaleX=-1;break;case 4:this.animationName="run2",this.atkAniName="atk2",this.node.scaleX=1}},t.prototype.randomImgAndName=function(){var e=this.node.parent.getChildByName("topImg"),t=n.default.getInstance().aiTitleImg.length,a=Math.floor(Math.random()*t);e.getChildByName("img").getComponent(cc.Sprite).spriteFrame=n.default.getInstance().aiTitleImg[a],e.getChildByName("name").getComponent(cc.Label).string=i.default.getInstance().node.getComponent("RandomName").initName()},t=__decorate([s],t)}(cc.Component);a.default=l,cc._RF.pop()},{"./DataManager":"DataManager","./GameManager":"GameManager","./MonsterManager":"MonsterManager"}],Player:[function(e,t,a){"use strict";cc._RF.push(t,"526f2JnCYdEg701aaeD/J2N","Player"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./GameManager"),r=e("./MonsterManager"),i=e("./UiManager"),o=e("./DataManager"),s=cc._decorator,c=s.ccclass,l=s.property,p=cc.Enum({idle:0,front_L:1,front_R:2,behind_L:3,behind_R:4}),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.background=null,t.player_state=p.idle,t.playerSpeed=5,t.rotationAngle=0,t.animationName=null,t.atkAniName=null,t.idleAniName=null,t.playerAction=null,t.isMove=!1,t.acionIsOver=!1,t.moveTime=6,t.speedX=2,t.speedY=2,t.timeCounter1=0,t.lastTime_state=p.idle,t.tempPosArr=[],t.tempPosIndex=0,t.skew1=100,t.skew2=140,t.maxDistance=300,t.atkTimes=0,t.isAtk=!1,t.interval=0,t}var a;return __extends(t,e),a=t,t.getInstance=function(){return a.instance},t.prototype.onLoad=function(){a.instance=this},t.prototype.start=function(){},t.prototype.playerClickMove=function(){this.background.on(cc.Node.EventType.TOUCH_END,function(e){this.playerAni(e)},this)},t.prototype.playerAni=function(e){var t=this.node.parent.parent.convertToWorldSpaceAR(this.node.position);this.isMove?(this.acionIsOver=!1,cc.director.getActionManager().removeAllActionsFromTarget(this.node.parent,!0),this.playerMoveTo(t,e.touch._point)):(this.isMove=!0,this.playerMoveTo(t,e.touch._point))},t.prototype.playerMoveTo=function(e,t){var a=this,r=this.player_state;this.rotationAngle=n.default.getInstance().getDegree(e,t),this.getClickAngle(this.rotationAngle),this.getAnimationName(),(r!=this.player_state||a.acionIsOver)&&this.node.getComponent(cc.Animation).play(this.animationName);var i=this.node.parent.parent.convertToNodeSpaceAR(e),o=a.node.parent.parent.convertToNodeSpaceAR(t),s=cc.v2(i.x-o.x,i.y-o.y).mag()/(50*this.playerSpeed);this.playerAction=cc.moveTo(s,o),this.node.parent.runAction(cc.sequence(this.playerAction,cc.callFunc(function(){a.node.getComponent(cc.Animation).play(this.idleAniName),a.isMove=!1,a.acionIsOver=!0},this)))},t.prototype.getClickAngle=function(e){e>=-90&&e<0?this.player_state=p.behind_L:e>=0&&e<90?this.player_state=p.behind_R:e>=90&&e<180?this.player_state=p.front_R:e>=180&&e<270&&(this.player_state=p.front_L)},t.prototype.getAnimationName=function(){switch(this.player_state){case 1:this.animationName="run1",this.idleAniName="idle1",this.atkAniName="atk1",this.node.scaleX=-1;break;case 2:this.animationName="run1",this.idleAniName="idle1",this.atkAniName="atk1",this.node.scaleX=1;break;case 3:this.animationName="run2",this.idleAniName="idle2",this.atkAniName="atk2",this.node.scaleX=-1;break;case 4:this.animationName="run2",this.idleAniName="idle2",this.atkAniName="atk2",this.node.scaleX=1}},t.prototype.update=function(e){var t=this;if(!this.isAtk){if(this.timeCounter1+=e,this.timeCounter1<this.moveTime){r.default.getInstance().replaceMonster(),this.lastTime_state=this.player_state;var a=n.default.getInstance().getDegree(cc.v2(0,0),cc.v2(this.speedX,this.speedY));this.getClickAngle(a),this.getAnimationName();var i=this.node.getComponent(cc.Animation).getAnimationState(this.animationName).isPlaying;this.lastTime_state==this.player_state&&i||this.node.getComponent(cc.Animation).play(this.animationName),this.node.parent.x+=this.speedX,this.node.parent.y+=this.speedY}else{this.getNearPlayerArr(),this.isAtk=!0,this.node.getComponent(cc.Animation).getAnimationState(this.idleAniName).isPlaying||this.node.getComponent(cc.Animation).play(this.idleAniName),this.schedule(function(){t.playerAttack()},1.4),this.change(),this.timeCounter1=0,this.lastTime_state=p.idle}this.check()}},t.prototype.change=function(){this.moveTime=4*Math.random()+2,this.speedX=1*Math.random()+1.8,this.speedY=1*Math.random()+1.8},t.prototype.check=function(){this.node.parent.x>r.default.getInstance().maxPos_x&&(this.speedX=-this.speedX,this.node.parent.x=r.default.getInstance().maxPos_x),this.node.parent.x<r.default.getInstance().minPos_x&&(this.speedX=-this.speedX,this.node.parent.x=r.default.getInstance().minPos_x),this.node.parent.y>r.default.getInstance().maxPos_y&&(this.speedY=-this.speedY,this.node.parent.y=r.default.getInstance().maxPos_y),this.node.parent.y<r.default.getInstance().minPos_y&&(this.speedY=-this.speedY,this.node.parent.y=r.default.getInstance().minPos_y)},t.prototype.getNearPlayerArr=function(){for(var e=-1;e<=1;e++)for(var t=-1;t<=1;t++)if(0!=e||0!=t){if(0==e||0==t)var a=this.node.parent.x+e*this.skew2,n=this.node.parent.y+t*this.skew2;else a=this.node.parent.x+e*this.skew1,n=this.node.parent.y+t*this.skew1;this.tempPosArr.push(cc.v2(a,n))}},t.prototype.emptyTempPosArr=function(){this.tempPosArr=[]},t.prototype.getNearestNode=function(e){var t=this.tempPosArr;if(0!=t.length){this.tempPosIndex=0;for(var a=t[0],r=0;r<t.length;r++){n.default.getInstance().getDistance(e,a)>n.default.getInstance().getDistance(e,t[r])&&(a=t[r],this.tempPosIndex=r)}return this.tempPosArr.splice(this.tempPosIndex,1),a}},t.prototype.playerAttack=function(){this.atkTimes+=1;var e=r.default.getInstance().tempMonsterArr;this.atkTimes>=3&&(this.atkTimes=0,this.unscheduleAllCallbacks(),0==e.length?(this.isAtk=!1,this.emptyTempPosArr()):this.skillEffect());if(0!=e.length){var t=e[Math.floor(Math.random()*e.length)].position,a=n.default.getInstance().getDegree(this.node.parent,t);this.getClickAngle(a),this.getAnimationName(),this.node.getComponent(cc.Animation).play(this.atkAniName)}},t.prototype.skillEffect=function(){var e=this;this.schedule(function(){if(r.default.getInstance().skillEffectPool.size()>0)var t=r.default.getInstance().skillEffectPool.get();else t=cc.instantiate(r.default.getInstance().skillEffectPrefab);t.parent=r.default.getInstance().effectParent;var a=200*Math.random()-100,i=5*Math.random()+200;t.position=cc.v2(e.node.parent.x+a,e.node.parent.y+i),t.scale=.5*Math.random()+.7;var o=t.scale;t.scaleX=[-1,1][Math.floor(2*Math.random())]*o,t.getComponent(cc.Animation).play();var s=t.getComponent(cc.Animation);s&&s.on("stop",function(e){e.detail;n.default.getInstance().destroyNode(t,r.default.getInstance().skillEffectPool)},e),e.interval=.1*Math.random()+.1,e.node.parent.parent.getChildByName("background").getComponent(cc.Animation).play()},this.interval,4),this.scheduleOnce(function(){e.dieEffect(),e.isAtk=!1,e.emptyTempPosArr()},.7)},t.prototype.dieEffect=function(){for(var e=r.default.getInstance().tempMonsterArr,t=e.length,a=0;a<t;a++){if(r.default.getInstance().dieEffectPool.size()>0)var i=r.default.getInstance().dieEffectPool.get();else i=cc.instantiate(r.default.getInstance().dieEffectPrefab);i.parent=r.default.getInstance().effectParent,i.position=e[a].position,e[a].children[0].getComponent("Monster").monsterAtkNum(),e[a].children[0].active=!1,i.getComponent(cc.Animation).play();var o=i.getComponent(cc.Animation);o&&o.on("stop",function(e){e.detail;n.default.getInstance().destroyNode(i,r.default.getInstance().dieEffectPool)},this)}this.scheduleOnce(function(){for(var e=0;e<t;e++)r.default.getInstance().tempMonsterArr[0].children[0].getComponent("Monster").monsterDie(),r.default.getInstance().tempMonsterArr.splice(0,1),r.default.getInstance().createRoundMonster()},.9),this.autoFightGetItem()},t.prototype.autoFightGetItem=function(){i.default.getInstance().updateTaskProgress(0);var e=Math.floor(100*Math.random())+o.default.getInstance().autoFightGetCoinNum,t=Math.floor(10*Math.random())+o.default.getInstance().autoFightGetExpNum;n.default.getInstance().getItemTips("\u83b7\u5f97\u91d1\u5e01",e),n.default.getInstance().getItemTips("\u83b7\u5f97\u7ecf\u9a8c",t),i.default.getInstance().addCoin(e),i.default.getInstance().addExp(t),n.default.getInstance().getEquipment(1)},t.instance=null,__decorate([l(cc.Node)],t.prototype,"background",void 0),t=a=__decorate([c],t)}(cc.Component);a.default=h,cc._RF.pop()},{"./DataManager":"DataManager","./GameManager":"GameManager","./MonsterManager":"MonsterManager","./UiManager":"UiManager"}],RandomName:[function(e,t,a){"use strict";cc._RF.push(t,"6c4a3SzEGdAIaVQFW0DhVzj","RandomName"),Object.defineProperty(a,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.first_name=[],t.last_name=[],t}return __extends(t,e),t.prototype.onLoad=function(){this.first_name=["\u8d75","\u94b1","\u5b59","\u674e","\u5468","\u5434","\u90d1","\u738b","\u51af","\u9648","\u891a","\u536b","\u848b","\u6c89","\u97e9","\u6768","\u6731","\u79e6","\u5c24","\u8bb8","\u8303","\u5f6d","\u90ce","\u6bb7","\u4f55","\u5415","\u65bd","\u5f20","\u5b54","\u66f9","\u4e25","\u534e","\u91d1","\u9b4f","\u9676","\u59dc","\u621a","\u8c22","\u90b9","\u55bb","\u67cf","\u6c34","\u7aa6","\u7ae0","\u4e91","\u82cf","\u6f58","\u845b","\u595a","\u9c81","\u97e6","\u660c","\u9a6c","\u82d7","\u51e4","\u82b1","\u65b9","\u4fde","\u4efb","\u8881","\u67f3","\u9146","\u9c8d","\u53f2","\u5510","\u8d39","\u5ec9","\u5c91","\u859b","\u96f7","\u8d3a","\u502a","\u6c64","\u6ed5","\u7f57","\u6bd5","\u90dd","\u90ac","\u5b89","\u5e38","\u4e50","\u4e8e","\u65f6","\u5085","\u76ae","\u535e","\u9f50","\u5eb7","\u4f0d","\u9980","\u5143","\u535c","\u987e","\u5b5f","\u5e73","\u9ec4","\u548c","\u7a46","\u8427","\u5c39","\u59da","\u90b5","\u6e5b","\u6c6a","\u7941","\u6bdb","\u79b9","\u72c4","\u7c73","\u8d1d","\u660e","\u81e7","\u8ba1","\u4f0f","\u6210","\u6234","\u8c08","\u5b8b","\u8305","\u5e9e","\u718a","\u7eaa","\u8212","\u5c48","\u9879","\u795d","\u8463","\u6881","\u675c","\u962e","\u84dd","\u95f5","\u5e2d","\u5b63","\u9ebb","\u5f3a","\u8d3e","\u8def","\u5a04","\u5371","\u6c5f","\u7ae5","\u989c","\u90ed","\u6885","\u76db","\u6797","\u5201","\u949f","\u5f90","\u90b1","\u9a86","\u9ad8","\u590f","\u8521","\u7530","\u6a0a","\u80e1","\u51cc","\u970d","\u865e","\u4e07","\u652f","\u67ef","\u661d","\u7ba1","\u5362","\u83ab","\u7ecf","\u623f","\u88d8","\u7f2a","\u5e72","\u89e3","\u5e94","\u5b97","\u4e01","\u5ba3","\u8d32","\u9093","\u90c1","\u5355","\u676d","\u6d2a","\u5305","\u8bf8","\u5de6","\u77f3","\u5d14","\u5409","\u94ae","\u9f9a","\u7a0b","\u5d47","\u90a2","\u6ed1","\u88f4","\u9646","\u8363","\u7fc1","\u8340","\u7f8a","\u4e8e","\u60e0","\u7504","\u66f2","\u5bb6","\u5c01","\u82ae","\u7fbf","\u50a8","\u9773","\u6c72","\u90b4","\u7cdc","\u677e","\u4e95","\u6bb5","\u5bcc","\u5deb","\u4e4c","\u7126","\u5df4","\u5f13","\u7267","\u9697","\u5c71","\u8c37","\u8f66","\u4faf","\u5b93","\u84ec","\u5168","\u90d7","\u73ed","\u4ef0","\u79cb","\u4ef2","\u4f0a","\u5bab","\u5b81","\u4ec7","\u683e","\u66b4","\u7518","\u94ad","\u5389","\u620e","\u7956","\u6b66","\u7b26","\u5218","\u666f","\u8a79","\u675f","\u9f99","\u53f6","\u5e78","\u53f8","\u97f6","\u90dc","\u9ece","\u84df","\u6ea5","\u5370","\u5bbf","\u767d","\u6000","\u84b2","\u90b0","\u4ece","\u9102","\u7d22","\u54b8","\u7c4d","\u8d56","\u5353","\u853a","\u5c60","\u8499","\u6c60","\u4e54","\u9634","\u9b31","\u80e5","\u80fd","\u82cd","\u53cc","\u95fb","\u8398","\u515a","\u7fdf","\u8c2d","\u8d21","\u52b3","\u9004","\u59ec","\u7533","\u6276","\u5835","\u5189","\u5bb0","\u90e6","\u96cd","\u5374","\u74a9","\u6851","\u6842","\u6fee","\u725b","\u5bff","\u901a","\u8fb9","\u6248","\u71d5","\u5180","\u6d66","\u5c1a","\u519c","\u6e29","\u522b","\u5e84","\u664f","\u67f4","\u77bf","\u960e","\u5145","\u6155","\u8fde","\u8339","\u4e60","\u5ba6","\u827e","\u9c7c","\u5bb9","\u5411","\u53e4","\u6613","\u614e","\u6208","\u5ed6","\u5ebe","\u7ec8","\u66a8","\u5c45","\u8861","\u6b65","\u90fd","\u803f","\u6ee1","\u5f18","\u5321","\u56fd","\u6587","\u5bc7","\u5e7f","\u7984","\u9619","\u4e1c","\u6b27","\u6bb3","\u6c83","\u5229","\u851a","\u8d8a","\u5914","\u9686","\u5e08","\u5de9","\u538d","\u8042","\u6641","\u52fe","\u6556","\u878d","\u51b7","\u8a3e","\u8f9b","\u961a","\u90a3","\u7b80","\u9976","\u7a7a","\u66fe","\u6bcb","\u6c99","\u4e5c","\u517b","\u97a0","\u987b","\u4e30","\u5de2","\u5173","\u84af","\u76f8","\u67e5","\u540e","\u8346","\u7ea2","\u6e38","\u90cf","\u7afa","\u6743","\u902f","\u76d6","\u76ca","\u6853","\u516c","\u4ec9","\u7763","\u5cb3","\u5e05","\u7f11","\u4ea2","\u51b5","\u90c8","\u6709","\u7434","\u5f52","\u6d77","\u664b","\u695a","\u95eb","\u6cd5","\u6c5d","\u9122","\u6d82","\u94a6","\u5546","\u725f","\u4f58","\u4f74","\u4f2f","\u8d4f","\u58a8","\u54c8","\u8c2f","\u7bc1","\u5e74","\u7231","\u9633","\u4f5f","\u8a00","\u798f","\u5357","\u706b","\u94c1","\u8fdf","\u6f06","\u5b98","\u51bc","\u771f","\u5c55","\u7e41","\u6a80","\u796d","\u5bc6","\u656c","\u63ed","\u821c","\u697c","\u758f","\u5192","\u6d51","\u631a","\u80f6","\u968f","\u9ad8","\u768b","\u539f","\u79cd","\u7ec3","\u5f25","\u4ed3","\u772d","\u8e47","\u8983","\u963f","\u95e8","\u607d","\u6765","\u7da6","\u53ec","\u4eea","\u98ce","\u4ecb","\u5de8","\u6728","\u4eac","\u72d0","\u90c7","\u864e","\u679a","\u6297","\u8fbe","\u675e","\u82cc","\u6298","\u9ea6","\u5e86","\u8fc7","\u7af9","\u7aef","\u9c9c","\u7687","\u4e93","\u8001","\u662f","\u79d8","\u7545","\u909d","\u8fd8","\u5bbe","\u95fe","\u8f9c","\u7eb5","\u4fb4","\u4e07\u4fdf","\u53f8\u9a6c","\u4e0a\u5b98","\u6b27\u9633","\u590f\u4faf","\u8bf8\u845b","\u95fb\u4eba","\u4e1c\u65b9","\u8d6b\u8fde","\u7687\u752b","\u7f8a\u820c","\u5c09\u8fdf","\u516c\u7f8a","\u6fb9\u53f0","\u516c\u51b6","\u5b97\u6b63","\u6fee\u9633","\u6df3\u4e8e","\u5355\u4e8e","\u592a\u53d4","\u7533\u5c60","\u516c\u5b59","\u4ef2\u5b59","\u8f69\u8f95","\u4ee4\u72d0","\u949f\u79bb","\u5b87\u6587","\u957f\u5b59","\u6155\u5bb9","\u9c9c\u4e8e","\u95fe\u4e18","\u53f8\u5f92","\u53f8\u7a7a","\u5140\u5b98","\u53f8\u5bc7","\u5357\u95e8","\u547c\u5ef6","\u5b50\u8f66","\u989b\u5b59","\u7aef\u6728","\u5deb\u9a6c","\u516c\u897f","\u6f06\u51cb","\u8f66\u6b63","\u58e4\u9a77","\u516c\u826f","\u62d3\u8dcb","\u5939\u8c37","\u5bb0\u7236","\u8c37\u6881","\u6bb5\u5e72","\u767e\u91cc","\u4e1c\u90ed","\u5fae\u751f","\u6881\u4e18","\u5de6\u4e18","\u4e1c\u95e8","\u897f\u95e8","\u5357\u5bab","\u7b2c\u4e94","\u516c\u4eea","\u516c\u4e58","\u592a\u53f2","\u4ef2\u957f","\u53d4\u5b59","\u5c48\u7a81","\u5c14\u6731","\u4e1c\u4e61","\u76f8\u88e1","\u80e1\u6bcd","\u53f8\u57ce","\u5f20\u5ed6","\u96cd\u95e8","\u6bcb\u4e18","\u8d3a\u5170","\u7da6\u6bcb","\u5c4b\u5e90","\u72ec\u5b64","\u5357\u90ed","\u5317\u5bab","\u738b\u5b59","\u7fbd","\u82b3","\u6708","\u82e5","\u53f1\u5412","\u9b54","\u5e7d","\u5415","\u4ed9"],this.last_name=["\u4f1f","\u521a","\u52c7","\u6bc5","\u4fca","\u5cf0","\u5f3a","\u519b","\u5e73","\u4fdd","\u4e1c","\u6587","\u8f89","\u529b","\u660e","\u6c38","\u5065","\u4e16","\u5e7f","\u5fd7","\u4e49","\u5174","\u826f","\u6d77","\u5c71","\u4ec1","\u6ce2","\u5b81","\u8d35","\u798f","\u751f","\u9f99","\u5143","\u5168","\u56fd","\u80dc","\u5b66","\u7965","\u624d","\u53d1","\u6b66","\u65b0","\u5229","\u6e05","\u98de","\u5f6c","\u5bcc","\u987a","\u4fe1","\u5b50","\u6770","\u6d9b","\u660c","\u6210","\u5eb7","\u661f","\u5149","\u5929","\u8fbe","\u5b89","\u5ca9","\u4e2d","\u8302","\u8fdb","\u6797","\u6709","\u575a","\u548c","\u5f6a","\u535a","\u8bda","\u5148","\u656c","\u9707","\u632f","\u58ee","\u4f1a","\u601d","\u7fa4","\u8c6a","\u5fc3","\u90a6","\u627f","\u4e50","\u7ecd","\u529f","\u677e","\u5584","\u539a","\u5e86","\u78ca","\u6c11","\u53cb","\u88d5","\u6cb3","\u54f2","\u6c5f","\u8d85","\u6d69","\u4eae","\u653f","\u8c26","\u4ea8","\u5947","\u56fa","\u4e4b","\u8f6e","\u7ff0","\u6717","\u4f2f","\u5b8f","\u8a00","\u82e5","\u9e23","\u670b","\u658c","\u6881","\u680b","\u7ef4","\u542f","\u514b","\u4f26","\u7fd4","\u65ed","\u9e4f","\u6cfd","\u6668","\u8fb0","\u58eb","\u4ee5","\u5efa","\u5bb6","\u81f4","\u6811","\u708e","\u5fb7","\u884c","\u65f6","\u6cf0","\u76db","\u96c4","\u741b","\u94a7","\u51a0","\u7b56","\u817e","\u6960","\u6995","\u98ce","\u822a","\u5f18","\u79c0","\u5a1f","\u82f1","\u534e","\u6167","\u5de7","\u7f8e","\u5a1c","\u9759","\u6dd1","\u60e0","\u73e0","\u7fe0","\u96c5","\u829d","\u7389","\u840d","\u7ea2","\u5a25","\u73b2","\u82ac","\u82b3","\u71d5","\u5f69","\u6625","\u83ca","\u5170","\u51e4","\u6d01","\u6885","\u7433","\u7d20","\u4e91","\u83b2","\u771f","\u73af","\u96ea","\u8363","\u7231","\u59b9","\u971e","\u9999","\u6708","\u83ba","\u5a9b","\u8c54","\u745e","\u51e1","\u4f73","\u5609","\u743c","\u52e4","\u73cd","\u8d1e","\u8389","\u6842","\u5a23","\u53f6","\u74a7","\u7490","\u5a05","\u7426","\u6676","\u598d","\u831c","\u79cb","\u73ca","\u838e","\u9526","\u9edb","\u9752","\u5029","\u5a77","\u59e3","\u5a49","\u5a34","\u747e","\u9896","\u9732","\u7476","\u6021","\u5a75","\u96c1","\u84d3","\u7ea8","\u4eea","\u8377","\u4e39","\u84c9","\u7709","\u541b","\u7434","\u854a","\u8587","\u83c1","\u68a6","\u5c9a","\u82d1","\u5a55","\u99a8","\u7457","\u7430","\u97f5","\u878d","\u56ed","\u827a","\u548f","\u537f","\u806a","\u6f9c","\u7eaf","\u6bd3","\u60a6","\u662d","\u51b0","\u723d","\u742c","\u8317","\u7fbd","\u5e0c","\u6b23","\u98d8","\u80b2","\u6ee2","\u99a5","\u7b60","\u67d4","\u7af9","\u972d","\u51dd","\u6653","\u6b22","\u9704","\u67ab","\u82b8","\u83f2","\u5bd2","\u4f0a","\u4e9a","\u5b9c","\u53ef","\u59ec","\u8212","\u5f71","\u8354","\u679d","\u4e3d","\u9633","\u59ae","\u5b9d","\u8d1d","\u521d","\u7a0b","\u68b5","\u7f61","\u6052","\u9e3f","\u6866","\u9a85","\u5251","\u5a07","\u7eaa","\u5bbd","\u82db","\u7075","\u739b","\u5a9a","\u742a","\u6674","\u5bb9","\u777f","\u70c1","\u5802","\u552f","\u5a01","\u97e6","\u96ef","\u82c7","\u8431","\u9605","\u5f66","\u5b87","\u96e8","\u6d0b","\u5fe0","\u5b97","\u66fc","\u7d2b","\u9038","\u8d24","\u8776","\u83e1","\u7eff","\u84dd","\u513f","\u7fe0","\u70df","\u5c0f","\u60dc","\u9738","\u4e3b","\u90e1","\u9b54","\u5e7d","\u591a","\u4ed9"]},t.prototype.start=function(){},t.prototype.initName=function(){return this.first_name[Math.floor(Math.random()*this.first_name.length)]+this.last_name[Math.floor(Math.random()*this.last_name.length)]},t=__decorate([r],t)}(cc.Component));a.default=i,cc._RF.pop()},{}],ShaderComponent:[function(e,t,a){"use strict";cc._RF.push(t,"6f6c8gMqhRA1rQMoc+yxWkc","ShaderComponent"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./ShaderManager"),r=cc._decorator,i=r.ccclass,o=r.property,s=r.requireComponent,c=r.executeInEditMode,l=[n.ShaderType.Fluxay,n.ShaderType.FluxaySuper],p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shader=n.ShaderType.Default,t._color=cc.color(),t._start=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"shader",{get:function(){return this._shader},set:function(e){this._shader=e,this._applyShader()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this._material},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.getComponent(cc.Sprite).setState(0),this._applyShader()},t.prototype.update=function(e){this._material&&(this._setShaderColor(),this._setShaderTime(e))},t.prototype._applyShader=function(){var e=this._shader,t=this.getComponent(cc.Sprite),a=n.default.useShader(t,e);this._material=a,this._start=0;var r=this._color;if(r.setR(255),r.setG(255),r.setB(255),r.setA(255),a){switch(e){case n.ShaderType.Blur:case n.ShaderType.GaussBlur:a.setNum(.02)}this._setShaderColor()}},t.prototype._setShaderColor=function(){var e=this.node,t=e.color,a=this._color,n=t.getR(),r=t.getG(),i=t.getB(),o=e.opacity,s=!1;a.getR()!==n&&(a.setR(n),s=!0),a.getG()!==r&&(a.setG(r),s=!0),a.getB()!==i&&(a.setB(i),s=!0),a.getA()!==o&&(a.setA(o),s=!0),s&&this._material.setColor(n/255,r/255,i/255,o/255)},t.prototype._setShaderTime=function(e){if(l.indexOf(this._shader)>=0){var t=this._start;t>65535&&(t=0),t+=e,this._material.setTime(t),this._start=t}},__decorate([o({type:cc.Enum(n.ShaderType),visible:!1})],t.prototype,"_shader",void 0),__decorate([o({type:cc.Enum(n.ShaderType)})],t.prototype,"shader",null),t=__decorate([i,c,s(cc.Sprite)],t)}(cc.Component);a.default=p,cc._RF.pop()},{"./ShaderManager":"ShaderManager"}],ShaderLab:[function(e,t,a){"use strict";cc._RF.push(t,"10b89mNdmVJZqAvOWAMX0w4","ShaderLab"),Object.defineProperty(a,"__esModule",{value:!0});var n="\nuniform mat4 viewProj;\nattribute vec3 a_position;\nattribute vec2 a_uv0;\nvarying vec2 uv0;\nvoid main () {\n    vec4 pos = viewProj * vec4(a_position, 1);\n    gl_Position = pos;\n    uv0 = a_uv0;\n}",r={GrayScaling:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    float gray = dot(c.rgb, vec3(0.299 * 0.5, 0.587 * 0.5, 0.114 * 0.5));\n    gl_FragColor = vec4(gray, gray, gray, c.a * 0.5);\n}\n"},Stone:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    float clrbright = (c.r + c.g + c.b) * (1. / 3.);\n    float gray = (0.6) * clrbright;\n    gl_FragColor = vec4(gray, gray, gray, c.a);\n}\n"},Ice:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 clrx = color * texture2D(texture, uv0);\n    float brightness = (clrx.r + clrx.g + clrx.b) * (1. / 3.);\n\tfloat gray = (1.5)*brightness;\n\tclrx = vec4(gray, gray, gray, clrx.a)*vec4(0.8,1.2,1.5,1);\n    gl_FragColor =clrx;\n}\n"},Frozen:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    c *= vec4(0.8, 1, 0.8, 1);\n\tc.b += c.a * 0.2;\n    gl_FragColor = c;\n}\n"},Mirror:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    c.r *= 0.5;\n    c.g *= 0.8;\n    c.b += c.a * 0.2;\n    gl_FragColor = c;\n}\n"},Poison:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    c.r *= 0.8;\n\tc.r += 0.08 * c.a;\n\tc.g *= 0.8;\n    c.g += 0.2 * c.a;\n\tc.b *= 0.8;\n    gl_FragColor = c;\n}\n"},Banish:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    float gg = (c.r + c.g + c.b) * (1.0 / 3.0);\n    c.r = gg * 0.9;\n    c.g = gg * 1.2;\n    c.b = gg * 0.8;\n    c.a *= (gg + 0.1);\n    gl_FragColor = c;\n}\n"},Vanish:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    float gray = (c.r + c.g + c.b) * (1. / 3.);\n    float rgb = gray * 0.8;\n    gl_FragColor = vec4(rgb, rgb, rgb, c.a * (gray + 0.1));\n}\n"},Invisible:{vert:n,frag:"\nvoid main () {\n    gl_FragColor = vec4(0,0,0,0);\n}\n"},Blur:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float num;\nvarying vec2 uv0;\nvoid main () {\n    vec4 sum = vec4(0.0);\n    vec2 size = vec2(num,num);\n    sum += texture2D(texture, uv0 - 0.4 * size) * 0.05;\n\tsum += texture2D(texture, uv0 - 0.3 * size) * 0.09;\n\tsum += texture2D(texture, uv0 - 0.2 * size) * 0.12;\n\tsum += texture2D(texture, uv0 - 0.1 * size) * 0.15;\n\tsum += texture2D(texture, uv0             ) * 0.16;\n\tsum += texture2D(texture, uv0 + 0.1 * size) * 0.15;\n\tsum += texture2D(texture, uv0 + 0.2 * size) * 0.12;\n\tsum += texture2D(texture, uv0 + 0.3 * size) * 0.09;\n    sum += texture2D(texture, uv0 + 0.4 * size) * 0.05;\n    \n    vec4 vectemp = vec4(0,0,0,0);\n    vec4 substract = vec4(0,0,0,0);\n    vectemp = (sum - substract) * color;\n\n    float alpha = texture2D(texture, uv0).a;\n    if(alpha < 0.05) { gl_FragColor = vec4(0 , 0 , 0 , 0); }\n\telse { gl_FragColor = vectemp; }\n}\n"},GaussBlur:{vert:n,frag:"\n#define repeats 5.\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float num;\nvarying vec2 uv0;\n\nvec4 draw(vec2 uv) {\n    return color * texture2D(texture,uv).rgba; \n}\nfloat grid(float var, float size) {\n    return floor(var*size)/size;\n}\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\nvoid main()\n{\n    vec4 blurred_image = vec4(0.);\n    for (float i = 0.; i < repeats; i++) { \n        vec2 q = vec2(cos(degrees((i/repeats)*360.)),sin(degrees((i/repeats)*360.))) * (rand(vec2(i,uv0.x+uv0.y))+num); \n        vec2 uv2 = uv0+(q*num);\n        blurred_image += draw(uv2)/2.;\n        q = vec2(cos(degrees((i/repeats)*360.)),sin(degrees((i/repeats)*360.))) * (rand(vec2(i+2.,uv0.x+uv0.y+24.))+num); \n        uv2 = uv0+(q*num);\n        blurred_image += draw(uv2)/2.;\n    }\n    blurred_image /= repeats;\n    gl_FragColor = vec4(blurred_image);\n}\n"},Dissolve:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float time;\nvarying vec2 uv0;\n\nvoid main()\n{\n    vec4 c = color * texture2D(texture,uv0);\n    float height = c.r;\n    if(height < time)\n    {\n        discard;\n    }\n    if(height < time+0.04)\n    {\n        // \u6eb6\u89e3\u989c\u8272\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\n        c = vec4(.9,.6,0.3,c.a);\n    }\n    gl_FragColor = c;\n}\n"},Fluxay:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float time;\nvarying vec2 uv0;\n\nvoid main()\n{\n    vec4 src_color = color * texture2D(texture, uv0).rgba;\n\n    float width = 0.06;       //\u6d41\u5149\u7684\u5bbd\u5ea6\u8303\u56f4 (\u8c03\u6574\u8be5\u503c\u6539\u53d8\u6d41\u5149\u7684\u5bbd\u5ea6)\n    float start = tan(time/1.414);  //\u6d41\u5149\u7684\u8d77\u59cbx\u5750\u6807\n    float strength = 0.008;   //\u6d41\u5149\u589e\u4eae\u5f3a\u5ea6   (\u8c03\u6574\u8be5\u503c\u6539\u53d8\u6d41\u5149\u7684\u589e\u4eae\u5f3a\u5ea6)\n    float offset = 0.5;      //\u504f\u79fb\u503c         (\u8c03\u6574\u8be5\u503c\u6539\u53d8\u6d41\u5149\u7684\u503e\u659c\u7a0b\u5ea6)\n    if(uv0.x < (start - offset * uv0.y) &&  uv0.x > (start - offset * uv0.y - width))\n    {\n        vec3 improve = strength * vec3(248, 208, 88);\n        vec3 result = improve * vec3( src_color.r, src_color.g, src_color.b);\n        gl_FragColor = vec4(result, src_color.a);\n\n    }else{\n        gl_FragColor = src_color;\n    }\n}\n"},FluxaySuper:{vert:n,frag:"\n#define TAU 6.12\n#define MAX_ITER 5\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float time;\nvarying vec2 uv0;\n\nvoid main()\n{\n    float time = time * .5+5.;\n    // uv should be the 0-1 uv of texture...\n    vec2 uv = uv0.xy;//fragCoord.xy / iResolution.xy;\n    \n    vec2 p = mod(uv*TAU, TAU)-250.0;\n\n    vec2 i = vec2(p);\n    float c = 1.0;\n    float inten = .0045;\n\n    for (int n = 0; n < MAX_ITER; n++) \n    {\n        float t =  time * (1.0 - (3.5 / float(n+1)));\n        i = p + vec2(cos(t - i.x) + sin(t + i.y), sin(t - i.y) + cos(1.5*t + i.x));\n        c += 1.0/length(vec2(p.x / (cos(i.x+t)/inten),p.y / (cos(i.y+t)/inten)));\n    }\n    c /= float(MAX_ITER);\n    c = 1.17-pow(c, 1.4);\n    vec4 tex = texture2D(texture,uv);\n    vec3 colour = vec3(pow(abs(c), 20.0));\n    colour = clamp(colour + vec3(0.0, 0.0, .0), 0.0, tex.a);\n\n    // \u6df7\u5408\u6ce2\u5149\n    float alpha = c*tex[3];  \n    tex[0] = tex[0] + colour[0]*alpha; \n    tex[1] = tex[1] + colour[1]*alpha; \n    tex[2] = tex[2] + colour[2]*alpha; \n    gl_FragColor = color * tex;\n}\n"}};a.default=r,cc._RF.pop()},{}],ShaderManager:[function(e,t,a){"use strict";cc._RF.push(t,"857cd4hejlIzYo+w2cPHuaC","ShaderManager"),Object.defineProperty(a,"__esModule",{value:!0});var n,r=e("./ShaderLab"),i=e("./ShaderMaterial");(function(e){e[e.Default=0]="Default",e[e.Gray=1]="Gray",e[e.GrayScaling=100]="GrayScaling",e[e.Stone=101]="Stone",e[e.Ice=102]="Ice",e[e.Frozen=103]="Frozen",e[e.Mirror=104]="Mirror",e[e.Poison=105]="Poison",e[e.Banish=106]="Banish",e[e.Vanish=107]="Vanish",e[e.Invisible=108]="Invisible",e[e.Blur=109]="Blur",e[e.GaussBlur=110]="GaussBlur",e[e.Dissolve=111]="Dissolve",e[e.Fluxay=112]="Fluxay",e[e.FluxaySuper=113]="FluxaySuper"})(n=a.ShaderType||(a.ShaderType={}));var o=function(){function e(){}return e.useShader=function(e,t){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){if(e&&e.spriteFrame&&e.getState()!==t){if(t>n.Gray){var a=n[t],o=r.default[a];if(!o)return void console.warn("Shader not defined",a);cc.dynamicAtlasManager.enabled=!1;var s=new i.default(a,o.vert,o.frag,o.defines||[]),c=e.spriteFrame.getTexture();s.setTexture(c),s.updateHash();var l=e;return l._material=s,l._renderData._material=s,l._state=t,s}e.setState(t)}}else console.warn("Shader not surpport for canvas")},e}();a.default=o,cc._RF.pop()},{"./ShaderLab":"ShaderLab","./ShaderMaterial":"ShaderMaterial"}],ShaderMaterial:[function(e,t,a){"use strict";cc._RF.push(t,"fd9abanrNpMfKL8/3l0ccKW","ShaderMaterial"),Object.defineProperty(a,"__esModule",{value:!0});var n=cc.renderer.renderEngine,r=function(e){function t(t,a,n,r){var i=e.call(this,!1)||this,o=cc.renderer._forward._programLib;return!o._templates[t]&&o.define(t,a,n,r),i._init(t),i}return __extends(t,e),t.prototype._init=function(e){var t=n.renderer,a=n.gfx,r=new t.Pass(e);r.setDepth(!1,!1),r.setCullMode(a.CULL_NONE),r.setBlend(a.BLEND_FUNC_ADD,a.BLEND_SRC_ALPHA,a.BLEND_ONE_MINUS_SRC_ALPHA,a.BLEND_FUNC_ADD,a.BLEND_SRC_ALPHA,a.BLEND_ONE_MINUS_SRC_ALPHA);var i=new t.Technique(["transparent"],[{name:"texture",type:t.PARAM_TEXTURE_2D},{name:"color",type:t.PARAM_COLOR4},{name:"pos",type:t.PARAM_FLOAT3},{name:"size",type:t.PARAM_FLOAT2},{name:"time",type:t.PARAM_FLOAT},{name:"num",type:t.PARAM_FLOAT}],[r]);this._texture=null,this._color={r:1,g:1,b:1,a:1},this._pos={x:0,y:0,z:0},this._size={x:0,y:0},this._time=0,this._num=0,this._effect=this.effect=new t.Effect([i],{color:this._color,pos:this._pos,size:this._size,time:this._time,num:this._num},[]),this._mainTech=i},t.prototype.setTexture=function(e){this._texture=e,this._texture.update({flipY:!1,mipmap:!1}),this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId()},t.prototype.setColor=function(e,t,a,n){this._color.r=e,this._color.g=t,this._color.b=a,this._color.a=n,this._effect.setProperty("color",this._color)},t.prototype.setPos=function(e,t,a){this._pos.x=e,this._pos.y=t,this._pos.z=a,this._effect.setProperty("pos",this._pos)},t.prototype.setSize=function(e,t){this._size.x=e,this._size.y=t,this._effect.setProperty("size",this._size)},t.prototype.setTime=function(e){this._time=e,this._effect.setProperty("time",this._time)},t.prototype.setNum=function(e){this._num=e,this._effect.setProperty("num",this._num)},t}(n.Material);a.default=r,cc._RF.pop()},{}],TaskList:[function(e,t,a){"use strict";cc._RF.push(t,"bbceaLcSfpNv4Zi8HZSrXnr","TaskList"),Object.defineProperty(a,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.taskArr=[],t}return __extends(t,e),t.prototype.onLoad=function(){this.taskArr=[{task_id:0,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:1,task_name:"\u7a7f\u6234\u4e00\u6b21\u88c5\u5907",state:0,progress:0,need_num:1,task_type:1},{task_id:2,task_name:"\u8fc7\u6cb3\u62c6\u68651-1",state:0,progress:0,need_num:1,task_type:4},{task_id:3,task_name:"\u62db\u52df\u4e00\u6b21\u82f1\u96c4",state:0,progress:0,need_num:1,task_type:3},{task_id:4,task_name:"\u953b\u9020\u4e00\u6b21\u88c5\u5907",state:0,progress:0,need_num:1,task_type:2},{task_id:5,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:6,task_name:"\u8fc7\u6cb3\u62c6\u68651-2",state:0,progress:0,need_num:1,task_type:4},{task_id:7,task_name:"\u5347\u7ea7\u4e24\u6b21\u88c5\u5907",state:0,progress:0,need_num:2,task_type:5},{task_id:8,task_name:"\u8fc7\u6cb3\u62c6\u68651-3",state:0,progress:0,need_num:1,task_type:4},{task_id:9,task_name:"\u953b\u9020\u4e00\u6b21\u88c5\u5907",state:0,progress:0,need_num:1,task_type:2},{task_id:10,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:11,task_name:"\u5947\u7b56\u5341\u4e8c1-1",state:0,progress:0,need_num:1,task_type:4},{task_id:12,task_name:"\u7a7f\u6234\u4e00\u6b21\u88c5\u5907",state:0,progress:0,need_num:1,task_type:1},{task_id:13,task_name:"\u5947\u7b56\u5341\u4e8c1-2",state:0,progress:0,need_num:1,task_type:4},{task_id:14,task_name:"\u5947\u7b56\u5341\u4e8c1-3",state:0,progress:0,need_num:1,task_type:3},{task_id:15,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:16,task_name:"\u70c8\u706b\u711a\u57ce1-1",state:0,progress:0,need_num:1,task_type:4},{task_id:17,task_name:"\u5347\u7ea7\u4e24\u6b21\u88c5\u5907",state:0,progress:0,need_num:2,task_type:5},{task_id:18,task_name:"\u70c8\u706b\u711a\u57ce1-2",state:0,progress:0,need_num:1,task_type:4},{task_id:19,task_name:"\u953b\u9020\u4e24\u6b21\u88c5\u5907",state:0,progress:0,need_num:2,task_type:2},{task_id:20,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:21,task_name:"\u70c8\u706b\u711a\u57ce1-3",state:0,progress:0,need_num:1,task_type:4},{task_id:22,task_name:"\u5347\u7ea7\u4e09\u6b21\u88c5\u5907",state:0,progress:0,need_num:3,task_type:5},{task_id:23,task_name:"\u4e71\u4e16\u67ad\u96c41-1",state:0,progress:0,need_num:1,task_type:4},{task_id:24,task_name:"\u953b\u9020\u4e09\u6b21\u88c5\u5907",state:0,progress:0,need_num:3,task_type:2},{task_id:25,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:26,task_name:"\u4e71\u4e16\u67ad\u96c41-2",state:0,progress:0,need_num:1,task_type:4},{task_id:27,task_name:"\u5347\u7ea7\u4e09\u6b21\u88c5\u5907",state:0,progress:0,need_num:3,task_type:5},{task_id:28,task_name:"\u4e71\u4e16\u67ad\u96c41-3",state:0,progress:0,need_num:1,task_type:4},{task_id:29,task_name:"\u953b\u9020\u4e09\u6b21\u88c5\u5907",state:0,progress:0,need_num:3,task_type:2},{task_id:30,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:31,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:32,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:33,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},{task_id:34,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0}]},t=__decorate([r],t)}(cc.Component));a.default=i,cc._RF.pop()},{}],UiManager:[function(e,t,a){"use strict";cc._RF.push(t,"9b7a8FPs0VMbYWwAYEXqAvS","UiManager"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./GameManager"),r=e("./MonsterManager"),i=e("./DataManager"),o=cc._decorator,s=o.ccclass,c=o.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.menuBtnParent=null,t.player=null,t.rolePanel=null,t.forgePanel=null,t.townPanel=null,t.backpackPanel=null,t.recruitingPanel=null,t.equipmentGrid=null,t.itemGrid=null,t.map=null,t.bossBgMap=null,t.popPanel=null,t.currentPanel=null,t.currentBtn=null,t.lastPanel=null,t.bg_top=null,t.topPanel=null,t.itemTipsPrefab=null,t.itemTipsPool=null,t.recycleEffectPrefab=null,t.recycleEffectPool=null,t.playerPropertyPanel=null,t.flyItemPrefabArray=[],t.flyItemPoolArray=[],t.heroIconArr=[],t.heroImgArr=[],t.forceImgArr=[],t.atkTypeImgArr=[],t.equipImgArr=[],t.fubenImgArr=[],t.mapArr=[],t.bossBgArr=[],t.petImgArr=[],t.playerIconArr=[],t.playerImgArr=[],t.playerPrefabArray=[],t.challengeType=0,t.sexType=0,t.isWin=!1,t.currentHeroId=0,t.currentEquipIndex=0,t.currentBpEquipArr=[],t.currentBpItemArr=[],t.currentFbProgressArr=[],t.currentCoinNum=0,t.currentExpNum=0,t.currentItemsId=0,t.currentTaskAward=0,t.taskProgressArr=[0,0,0,0,0,0],t.currentTask={task_id:0,task_name:"\u51fb\u9000\u4e24\u6ce2\u654c\u4eba",state:0,progress:0,need_num:2,task_type:0},t.currentTaskId=0,t.currentHeroProperty={level:1,attack:100,power:100,cure:10,lifeValue:500,name:"",force:0,atkType:0,baoJi:100,baoJiRatio:.2,equipArray:[0,0,0,0],equipLevelArray:[0,0,0,0]},t.currentHeroLockArr=[],t.currentPlayerProperty={level:1,attack:100,power:100,cure:10,lifeValue:500,name:"",force:0,atkType:0,baoJi:100,baoJiRatio:.2,equipArray:[0,0,0,0],equipLevelArray:[0,0,0,0]},t.hero1={level:0,attack:100,power:0,cure:0,lifeValue:500,name:"",force:0,atkType:0,baoJi:100,baoJiRatio:.2,equipArray:[0,0,0,0],equipLevelArray:[0,0,0,0]},t.hero2={level:1,attack:100,power:100,cure:10,lifeValue:500,name:"",force:0,atkType:0,baoJi:100,baoJiRatio:.2,equipArray:[0,0,0,0],equipLevelArray:[0,0,0,0]},t}var a;return __extends(t,e),a=t,t.getInstance=function(){return a.instance},t.prototype.onLoad=function(){a.instance=this,this.initData(),this.initGame()},t.prototype.initData=function(){this.currentPlayerProperty=i.default.getInstance().playerProperty,this.hero1=i.default.getInstance().hero1,this.hero2=i.default.getInstance().hero2,this.currentHeroLockArr=i.default.getInstance().heroLockArr,this.currentBpEquipArr=i.default.getInstance().equipBackpackArr,this.currentBpItemArr=i.default.getInstance().itemBackpackArr,this.currentCoinNum=i.default.getInstance().coinNum,this.currentExpNum=i.default.getInstance().expNum,this.currentFbProgressArr=i.default.getInstance().fubenProgressArr,this.currentTaskId=i.default.getInstance().taskId,this.currentTask=i.default.getInstance().currentTask,this.currentTaskAward=200+Math.floor(200*Math.random()),this.sexType=i.default.getInstance().sexType},t.prototype.initGame=function(){this.bg_top=this.node.getChildByName("bg_top"),this.playerPropertyPanel=this.node.getChildByName("playerPropertyPanel"),this.popPanel=this.node.getChildByName("popPanel"),this.topPanel=this.node.getChildByName("topPanel"),this.initPlayerType(),this.initMenuBtnClick(),this.initPool(),this.initMap(),this.initCoinLabel(),this.initPlayerName(),this.initPlayerExp(),this.switchHero(this.rolePanel),this.switchHero(this.forgePanel),this.initBackPackEquip(),this.updateBackPackItem(),this.updateTaskMenu()},t.prototype.initPlayerType=function(){var e=this.sexType;this.rolePanel.getChildByName("playerImg").getComponent(cc.Sprite).spriteFrame=this.playerImgArr[e],n.default.getInstance().playerCamp.children[0].getChildByName("img").getComponent(cc.Sprite).spriteFrame=this.playerImgArr[e],this.playerPropertyPanel.getChildByName("icon_player").getComponent(cc.Sprite).spriteFrame=this.playerIconArr[e],this.rolePanel.getChildByName("heroGroup").children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.playerIconArr[e],this.forgePanel.getChildByName("heroGroup").children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.playerIconArr[e];var t=cc.find("Canvas/root"),a=cc.instantiate(this.playerPrefabArray[this.sexType]);a.parent=t,a.position=cc.v2(425,428),t.getComponent("Camera").target=a,this.player=a},t.prototype.initPool=function(){var e=this;this.itemTipsPool=new cc.NodePool,this.recycleEffectPool=new cc.NodePool;for(var t=0;t<1;t++)this.itemTipsPool.put(cc.instantiate(this.itemTipsPrefab));this.schedule(function(){e.recycleEffectPool.put(cc.instantiate(e.recycleEffectPrefab))},.5,5,0)},t.prototype.initMap=function(){this.currentTaskId>5&&(this.map.getComponent(cc.Sprite).spriteFrame=this.mapArr[1],this.bossBgMap.getComponent(cc.Sprite).spriteFrame=this.bossBgArr[1],r.default.getInstance().monsterIndex=2)},t.prototype.initMenuBtnClick=function(){var e=this,t=this.menuBtnParent.getChildByName("btn_fighting"),a=this.menuBtnParent.getChildByName("btn_squad"),n=this.menuBtnParent.getChildByName("btn_forge"),r=this.menuBtnParent.getChildByName("btn_city"),i=this.menuBtnParent.getChildByName("btn_backpack"),o=this.menuBtnParent.getChildByName("btn_recruiting");this.currentBtn=t,t.on(cc.Node.EventType.TOUCH_END,function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":100}');null!=e.currentPanel&&(e.currentPanel.active=!1,e.bg_top.active=!1),e.currentBtn.scale=1,e.currentBtn=t,e.currentBtn.scale=1.1},this),a.on(cc.Node.EventType.TOUCH_END,function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":101}');e.displayPanel(e.rolePanel,a),e.defaultPlayerDisPlay()},this),n.on(cc.Node.EventType.TOUCH_END,function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":102}');e.displayPanel(e.forgePanel,n),e.defaultPlayerDisPlay()},this),r.on(cc.Node.EventType.TOUCH_END,function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":103}');e.displayPanel(e.townPanel,r),e.bg_top.active=!1},this),i.on(cc.Node.EventType.TOUCH_END,function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":104}');e.displayPanel(e.backpackPanel,i)},this),o.on(cc.Node.EventType.TOUCH_END,function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":105}');e.displayPanel(e.recruitingPanel,o)},this)},t.prototype.displayPanel=function(e,t){this.recruitingPanel,n.default.getInstance().heroImgIsScroll=!0,null!=this.currentPanel&&(this.currentPanel.active=!1),e.active=!0,this.currentPanel=e,this.currentBtn.scale=1,this.currentBtn=t,this.bg_top.active=!0,this.currentBtn.scale=1.1},t.prototype.initCoinLabel=function(){var e=[],t=this.playerPropertyPanel.getChildByName("bg_top").children[1].children[2],a=this.bg_top.children[1].children[2];e.push(t,a);for(var n=0;n<2;n++)e[n].getComponent(cc.Label).string=i.default.getInstance().numToString(this.currentCoinNum)},t.prototype.initPlayerExp=function(){var e=i.default.getInstance().getPlayerLevelFromExp(this.currentExpNum),t=15*(e-1)*(e-1)+85*(e-1),a=(this.currentExpNum-t)/(70+30*e);this.menuBtnParent.getChildByName("expProgress").children[0].getComponent(cc.Label).string=this.currentExpNum+" / "+(15*e*e+85*e),this.menuBtnParent.getChildByName("expProgress").getComponent(cc.Sprite).fillRange=a,this.playerPropertyPanel.getChildByName("levelNum").getComponent(cc.Label).string="Lv."+i.default.getInstance().getPlayerLevelFromExp(this.currentExpNum)},t.prototype.initPlayerName=function(){this.playerPropertyPanel.getChildByName("playerName").getComponent(cc.Label).string=this.currentPlayerProperty.name,this.player.getChildByName("topImg").getChildByName("name").getComponent(cc.Label).string=this.currentPlayerProperty.name},t.prototype.initBackPackEquip=function(){for(var e=0;e<this.currentBpEquipArr.length;e++){if(n.default.getInstance().equipmentPool.size()>0)var t=n.default.getInstance().equipmentPool.get();else t=cc.instantiate(n.default.getInstance().equipmentPrefab);var a=this.currentBpEquipArr[e];t.parent=this.equipmentGrid,t.getChildByName("img").getComponent(cc.Sprite).spriteFrame=this.equipImgArr[a];var r=i.default.getInstance().getEqipNameFromId(a,0,0);t.getChildByName("name").getComponent(cc.Label).string=r+"",t.name=a.toString()}this.updateBackPackCapacity()},t.prototype.updatePowerNum=function(){for(var e=this.currentPlayerProperty.power,t=0;t<2;t++)1==this.currentHeroLockArr[t]&&(0==t&&(e+=this.hero1.power),1==t&&(e+=this.hero2.power));var a=[],n=this.playerPropertyPanel.getChildByName("bg_top").children[0].children[2],r=this.bg_top.children[0].children[2];a.push(n,r);for(t=0;t<2;t++)a[t].getComponent(cc.Label).string=e},t.prototype.updateBackPackCapacity=function(){this.backpackPanel.getChildByName("backPackCapacity").children[1].getComponent(cc.Label).string=this.currentBpEquipArr.length+"/"+i.default.getInstance().backPackCapacity},t.prototype.updateBackPackItem=function(){for(var e=0;e<8;e++)void 0==this.currentBpItemArr[e]&&(this.currentBpItemArr[e]=0),this.currentBpItemArr[e]<=0?(this.itemGrid.children[e].active=!1,void 0!=this.itemGrid.children[e].children[2]&&this.itemGrid.children[e].children[2].getComponent(cc.Animation).stop()):(this.itemGrid.children[e].active=!0,this.itemGrid.children[e].getChildByName("num").getComponent(cc.Label).string="x"+this.currentBpItemArr[e],void 0!=this.itemGrid.children[e].children[2]&&this.itemGrid.children[e].children[2].getComponent(cc.Animation).play());i.default.getInstance().saveDataToLocal(3)},t.prototype.addCoin=function(e){this.currentCoinNum+=e,this.initCoinLabel(),i.default.getInstance().saveDataToLocal(4)},t.prototype.addExp=function(e){this.currentExpNum+=e,this.initPlayerExp(),i.default.getInstance().saveDataToLocal(4)},t.prototype.addPower=function(e,t,a){this.currentHeroProperty.power+=Math.floor(10*Math.random())+e,this.currentHeroProperty.lifeValue+=Math.floor(10*Math.random())+t,this.currentHeroProperty.attack+=Math.floor(10*Math.random())+a,i.default.getInstance().saveDataToLocal(1),this.updateRolePanel()},t.prototype.panelReturnBtnClick=function(){i.default.getInstance().reportData(134),null!=this.currentPanel&&(this.currentPanel.active=!1,this.bg_top.active=!1),this.currentBtn.scale=1,this.currentBtn=this.menuBtnParent.getChildByName("btn_fighting"),this.currentBtn.scale=1.1},t.prototype.switchHero=function(e){for(var t=this,a=e.getChildByName("heroGroup"),n=0;n<4;n++)a.children[n].on(cc.Node.EventType.TOUCH_END,function(e){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":111}');var a=e.target.name,n=a.substr(a.length-1,1),r=t.currentHeroId;switch(t.currentHeroId=parseInt(n)-1,t.currentHeroId){case 0:t.currentHeroProperty=t.currentPlayerProperty,t.updateRolePanel(),t.updateForgePanel();break;case 1:0!=t.currentHeroLockArr[t.currentHeroId-1]?(t.currentHeroProperty=t.hero1,t.updateRolePanel(),t.updateForgePanel()):(t.popPanel.getChildByName("addHeroPanel").active=!0,t.currentHeroId=r);break;case 2:0!=t.currentHeroLockArr[t.currentHeroId-1]?(t.currentHeroProperty=t.hero2,t.updateRolePanel(),t.updateForgePanel()):(t.popPanel.getChildByName("addHeroPanel").active=!0,t.currentHeroId=r);break;case 3:t.popPanel.getChildByName("addHeroPanel").active=!0,t.currentHeroId=r}},this)},t.prototype.equipClickFun=function(e){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":117}');var t=e.target.name,a=t.substr(t.length-1,1);this.currentEquipIndex=parseInt(a)-1,0==this.currentHeroProperty.equipArray[this.currentEquipIndex]&&this.commonTipsPop("\u8bf7\u5148\u83b7\u53d6\u88c5\u5907"),this.forgeEquipDisplay()},t.prototype.forgeEquipDisplay=function(){var e=this.forgePanel.getChildByName("forgeEquipPanel");if(this.forgePanel.getChildByName("equipNode").children[0].position=cc.v2(0,-131*(this.currentEquipIndex+1)),0==this.currentHeroProperty.equipArray[this.currentEquipIndex])e.active=!1;else{var t=this.currentHeroProperty.equipArray[this.currentEquipIndex];e.active=!0,e.getChildByName("equipImg").getComponent(cc.Sprite).spriteFrame=this.equipImgArr[this.currentEquipIndex],e.getChildByName("equipName").getComponent(cc.Label).string=i.default.getInstance().getEqipNameFromId(this.currentEquipIndex,0,1)+"",e.getChildByName("beforeForge").children[0].getComponent(cc.Label).string="\u5f3a\u5316"+t+"\u7ea7",e.getChildByName("beforeForge").children[1].getComponent(cc.Label).string=i.default.getInstance().getEqipNameFromId(this.currentEquipIndex,4,1)+"+"+12*t,e.getChildByName("afterForge").children[0].getComponent(cc.Label).string="\u5f3a\u5316"+(t+1)+"\u7ea7",e.getChildByName("afterForge").children[1].getComponent(cc.Label).string=i.default.getInstance().getEqipNameFromId(this.currentEquipIndex,4,1)+"+"+12*(t+1)}},t.prototype.defaultPlayerDisPlay=function(){this.currentHeroId=0,this.updateHeroDisPlay(),this.currentHeroProperty=this.currentPlayerProperty,this.updateRolePanel(),this.updateForgePanel();for(var e=this.rolePanel.getChildByName("heroGroup"),t=0;t<2;t++){for(var a=0;a<4;a++)e.children[a].children[1].active=0==a;e=this.forgePanel.getChildByName("heroGroup")}},t.prototype.updateHeroDisPlay=function(){for(var e=this.rolePanel.getChildByName("heroGroup"),t=0;t<2;t++){for(var a=1;a<4;a++)0==this.currentHeroLockArr[a-1]?(e.children[a].children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.heroIconArr[0],e.children[a].children[1].opacity=0):(e.children[a].children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.heroIconArr[a],e.children[a].children[1].opacity=255);e=this.forgePanel.getChildByName("heroGroup")}},t.prototype.updateRolePanel=function(){0==this.currentHeroId?(this.rolePanel.getChildByName("kingdomTypeImg").active=!1,this.rolePanel.getChildByName("playerImg").getComponent(cc.Sprite).spriteFrame=this.playerImgArr[this.sexType]):(this.rolePanel.getChildByName("kingdomTypeImg").active=!0,this.rolePanel.getChildByName("kingdomTypeImg").getComponent(cc.Sprite).spriteFrame=this.forceImgArr[this.currentHeroProperty.force],this.rolePanel.getChildByName("playerImg").getComponent(cc.Sprite).spriteFrame=this.heroImgArr[this.currentHeroId]),this.rolePanel.getChildByName("playerName").children[0].getComponent(cc.Label).string=this.currentHeroProperty.name,this.rolePanel.getChildByName("fightNum").children[0].getComponent(cc.Label).string=this.currentHeroProperty.power+"",this.updatePowerNum(),this.rolePanel.getChildByName("attackTypeImg").getComponent(cc.Sprite).spriteFrame=this.atkTypeImgArr[this.currentHeroProperty.atkType];for(var e=this.rolePanel.getChildByName("equipGrid"),t=0;t<4;t++)0==this.currentHeroProperty.equipArray[t]?(e.children[t].getChildByName("item").active=!1,e.children[t].getChildByName("img_empty").active=!0):(e.children[t].getChildByName("item").active=!0,e.children[t].getChildByName("img_empty").active=!1),e.children[t].getChildByName("item").getChildByName("levelNum").getComponent(cc.Label).string="Lv."+this.currentHeroProperty.equipLevelArray[t],e.children[t].getChildByName("item").getChildByName("forgeNum").getComponent(cc.Label).string="+"+this.currentHeroProperty.equipArray[t]},t.prototype.updateForgePanel=function(){for(var e=this.forgePanel.getChildByName("equipNode"),t=1;t<5;t++)0==this.currentHeroProperty.equipArray[t-1]?(e.children[t].getChildByName("equip").active=!1,e.children[t].getChildByName("addImg").active=!0):(e.children[t].getChildByName("equip").active=!0,e.children[t].getChildByName("addImg").active=!1),e.children[t].getChildByName("equip").children[1].getComponent(cc.Label).string="\u5f3a\u5316"+this.currentHeroProperty.equipArray[t-1]+"\u7ea7";this.forgeEquipDisplay()},t.prototype.changePlayerRole=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":112}');for(var e=0;e<4;e++)if(this.currentBpEquipArr.indexOf(e)>-1&&0==this.currentHeroProperty.equipArray[e]){this.currentHeroProperty.equipArray[e]=1;var t=this.currentBpEquipArr.indexOf(e);this.currentBpEquipArr.splice(t,1),n.default.getInstance().destroyNode(this.equipmentGrid.children[0],n.default.getInstance().equipmentPool),i.default.getInstance().saveDataToLocal(3),this.addPower(200,8,5),this.updateTaskProgress(1)}this.updateRolePanel(),this.updateBackPackCapacity(),i.default.getInstance().saveDataToLocal(1)},t.prototype.equipLevelUpBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":114}');var e=this.currentCoinNum-3e3;if(e<0)this.commonTipsPop("\u91d1\u5e01\u4e0d\u8db3");else{this.currentCoinNum=e,i.default.getInstance().saveDataToLocal(4),this.initCoinLabel();for(var t=0;t<4;t++)0==this.currentHeroProperty.equipArray[t]||(this.currentHeroProperty.equipLevelArray[t]+=1);this.addPower(628,9,6),this.updateRolePanel(),i.default.getInstance().saveDataToLocal(1),this.updateTaskProgress(5)}},t.prototype.equipForgeBtnClick=function(){var e=this.currentBpItemArr[3]-5;e<0?this.commonTipsPop("\u953b\u9020\u77f3\u4e0d\u8db3"):(this.addPower(228,3,2),this.currentBpItemArr[3]=e,i.default.getInstance().saveDataToLocal(3),this.updateBackPackItem(),this.currentHeroProperty.equipArray[this.currentEquipIndex]+=1,this.updateForgePanel(),i.default.getInstance().saveDataToLocal(1),this.updateTaskProgress(2))},t.prototype.detailsBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":113}');var e=this.rolePanel.getChildByName("detailsWindow");e.active=!0,0==this.currentHeroId?(e.getChildByName("kingdomTypeImg").active=!1,e.getChildByName("playerImg").getComponent(cc.Sprite).spriteFrame=this.playerImgArr[this.sexType]):(e.getChildByName("kingdomTypeImg").active=!0,e.getChildByName("kingdomTypeImg").getComponent(cc.Sprite).spriteFrame=this.forceImgArr[this.currentHeroProperty.force],e.getChildByName("playerImg").getComponent(cc.Sprite).spriteFrame=this.heroImgArr[this.currentHeroId]),e.getChildByName("playerImg").getComponent(cc.Animation).play(),e.getChildByName("attackTypeImg").getComponent(cc.Sprite).spriteFrame=this.atkTypeImgArr[this.currentHeroProperty.atkType],e.getChildByName("hpNum").getComponent(cc.Label).string=this.currentHeroProperty.lifeValue+"",e.getChildByName("hitNum").getComponent(cc.Label).string=this.currentHeroProperty.attack+"",e.getChildByName("defenseNum").getComponent(cc.Label).string=this.currentHeroProperty.cure+"",e.getChildByName("baojiNum").getComponent(cc.Label).string=this.currentHeroProperty.baoJi+"",e.getChildByName("baojilvNum").getComponent(cc.Label).string=this.currentHeroProperty.baoJiRatio+""},t.prototype.detailsCloseBtnClick=function(e){var t=e.target.parent;t.active=!1,t.getChildByName("playerImg").getComponent(cc.Animation).stop()},t.prototype.closeBtnClick=function(e){i.default.getInstance().reportData(135),e.target.parent.active=!1},t.prototype.treasureBtnClick=function(e){this.popPanel.getChildByName("getTreasurePanel").active=!0},t.prototype.backPackEquipBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":122}');this.equipmentGrid.active=!0,this.itemGrid.active=!1,this.backpackPanel.getChildByName("backPackCapacity").active=!0,this.backpackPanel.getChildByName("btnForge").active=!0},t.prototype.backPackItemBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":122}');this.equipmentGrid.active=!1,this.itemGrid.active=!0,this.backpackPanel.getChildByName("backPackCapacity").active=!1,this.backpackPanel.getChildByName("btnForge").active=!1},t.prototype.backPackItemsClick=function(e){var t=e.target.name,a=t.substr(t.length-1,1),n=parseInt(a)-1;this.currentItemsId=n,this.backpackPanel.getChildByName("equipDetails").active=!0;var r=this.backpackPanel.getChildByName("equipDetails").getChildByName("itemBg");if(r.getChildByName("name").getComponent(cc.Label).string=e.target.getChildByName("name").getComponent(cc.Label).string,r.getChildByName("img").getComponent(cc.Sprite).spriteFrame=e.target.getChildByName("img").getComponent(cc.Sprite).spriteFrame,r.getChildByName("num").getComponent(cc.Label).string="\u62e5\u6709\uff1a"+this.currentBpItemArr[this.currentItemsId],r.getChildByName("imgFrame").getComponent(cc.Sprite).spriteFrame=e.target.getComponent(cc.Sprite).spriteFrame,this.currentItemsId>3){var o=i.default.getInstance().getHeroSyntheicNum(this.currentItemsId);r.getChildByName("syntheticLabel").active=!0,r.getChildByName("syntheticLabel").getComponent(cc.Label).string="\u5408\u6210\u8be5\u82f1\u96c4\u9700\u8981"+o+"\u788e\u7247",r.getChildByName("syntheticLabel").children[0].getComponent(cc.RichText).string="<color=#ff0000>"+this.currentBpItemArr[this.currentItemsId]+"</c><color=#643200>/"+o+"</color>",this.backpackPanel.getChildByName("equipDetails").getChildByName("useBtn").active=!1}else r.getChildByName("syntheticLabel").active=!1,this.backpackPanel.getChildByName("equipDetails").getChildByName("useBtn").active=!0},t.prototype.useItemsBtnClick=function(e){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":125}');var t=this.backpackPanel.getChildByName("equipDetails").getChildByName("itemBg");if(this.currentBpItemArr[this.currentItemsId]<=0)this.commonTipsPop("\u6ca1\u6709\u6b64\u7269\u54c1");else{switch(this.currentItemsId){case 0:var a=i.default.getInstance().h_expBookNum;this.addExp(a),this.currentBpItemArr[this.currentItemsId]-=1,n.default.getInstance().getItemTips("\u7ecf\u9a8c",a),t.getChildByName("num").getComponent(cc.Label).string="\u62e5\u6709\uff1a"+this.currentBpItemArr[this.currentItemsId];break;case 1:a=i.default.getInstance().l_expBookNum;this.addExp(a),this.currentBpItemArr[this.currentItemsId]-=1,n.default.getInstance().getItemTips("\u7ecf\u9a8c",a),t.getChildByName("num").getComponent(cc.Label).string="\u62e5\u6709\uff1a"+this.currentBpItemArr[this.currentItemsId];break;case 2:this.currentBpItemArr[this.currentItemsId]-=1,t.getChildByName("num").getComponent(cc.Label).string="\u62e5\u6709\uff1a"+this.currentBpItemArr[this.currentItemsId];var r=Math.ceil(4*Math.random())+3;a=Math.ceil(2*Math.random());this.currentBpItemArr[r]+=a,n.default.getInstance().getItemTips(i.default.getInstance().getItemName(r),a),this.updateBackPackItem();break;case 3:var o=this.menuBtnParent.getChildByName("btn_forge");this.displayPanel(this.forgePanel,o),this.defaultPlayerDisPlay(),e.target.parent.active=!1}this.updateBackPackItem(),i.default.getInstance().saveDataToLocal(3),i.default.getInstance().saveDataToLocal(4)}},t.prototype.recruitBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":126}');this.recruitingPanel.getChildByName("recruitPanel").active=!0,this.recruitingPanel.getChildByName("shopPanel").active=!1},t.prototype.shopBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":126}');this.recruitingPanel.getChildByName("recruitPanel").active=!1,this.recruitingPanel.getChildByName("shopPanel").active=!0},t.prototype.recycleEquipment=function(){var e=this;if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":123}');if(!(this.equipmentGrid.childrenCount<=0)){for(var t=0,a=this.equipmentGrid.childrenCount,r=0;r<a;r++){var o=this.equipmentGrid.children[r];this.recycleEffectAni(o);var s=parseInt(o.name),c=i.default.getInstance().getEqipNameFromId(s,2,1).toString();t+=parseInt(c)}this.scheduleOnce(function(){n.default.getInstance().getItemTips("\u91d1\u5e01",t),n.default.getInstance().getItemTips("\u953b\u9020\u77f3",a),e.currentBpItemArr[3]+=a,i.default.getInstance().saveDataToLocal(3),e.updateBackPackItem();for(var r=0;r<a;r++)n.default.getInstance().destroyNode(e.equipmentGrid.children[0],n.default.getInstance().equipmentPool);e.addCoin(t),e.currentBpEquipArr=[],i.default.getInstance().saveDataToLocal(3),e.updateBackPackCapacity()},.8)}},t.prototype.recruitHero=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":127}');var e=this.currentCoinNum-8e3;e<0?this.commonTipsPop("\u91d1\u5e01\u4e0d\u8db3"):(this.currentCoinNum=e,i.default.getInstance().saveDataToLocal(4),this.initCoinLabel(),this.recruitHeroRatio(),this.updateBackPackItem(),this.updateTaskProgress(3))},t.prototype.recruitHeroRatio=function(){for(var e=0;e<2;e++)if(0==this.currentHeroLockArr[e]){if(0==e)return this.currentHeroLockArr[e]=1,this.recruitHeroSuccess(9),this.updateHeroDisPlay(),void i.default.getInstance().saveDataToLocal(2);if(1==e&&1*Math.random()>.8)return this.currentHeroLockArr[e]=1,this.recruitHeroSuccess(10),this.updateHeroDisPlay(),void i.default.getInstance().saveDataToLocal(2)}var t=Math.ceil(4*Math.random())+3,a=Math.ceil(3*Math.random());this.currentBpItemArr[t]+=a,n.default.getInstance().getItemTips(i.default.getInstance().getItemName(t),a)},t.prototype.recruitHeroSuccess=function(e){var t=this.popPanel.getChildByName("newHeroPanel");t.active=!0,t.getChildByName("img").getComponent(cc.Sprite).spriteFrame=n.default.getInstance().bossImgArr[e]},t.prototype.exChangeItem=function(e){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":128}');var t=e.target.parent.name,a=t.substr(t.length-1,1),r=parseInt(a)-1;r<=3?(this.currentBpItemArr[r]+=1,n.default.getInstance().getItemTips(i.default.getInstance().getItemName(r),1),this.updateBackPackItem()):this.commonTipsPop("90\u7ea7\u5f00\u542f")},t.prototype.bossBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":106}');this.popPanel.getChildByName("chooseBossPanel").active=!0},t.prototype.challengeBossBtnClick=function(e){if(n.default.getInstance().isResetOver){var t=e.target.parent.name.substring(5),a=parseInt(t),r=i.default.getInstance().getPlayerLevelFromExp(this.currentExpNum),o=i.default.getInstance().levelLimitArr[a-1];r<o?this.commonTipsPop(o+"\u7ea7\u89e3\u9501"):(a>8&&(a=8),n.default.getInstance().bossLevelId=a,n.default.getInstance().fightModel=0,this.popPanel.getChildByName("chooseBossPanel").active=!1,n.default.getInstance().enterFightingScene())}},t.prototype.recycleEffectAni=function(e){var t=this;if(this.recycleEffectPool.size()>0)var a=this.recycleEffectPool.get();else a=cc.instantiate(this.recycleEffectPrefab);a.parent=e,a.position=cc.v2(38,-43),a.getComponent(cc.Animation).play(),this.scheduleOnce(function(){n.default.getInstance().destroyNode(a,t.recycleEffectPool)},.8)},t.prototype.winGame=function(){var e=this.popPanel.getChildByName("overPanel");e.active=!0,e.getChildByName("winPanel").active=!0,e.getChildByName("failedPanel").active=!1,this.isWin=!0,e.getChildByName("winPanel").getChildByName("lightCircle").getComponent(cc.Animation).play(),0==n.default.getInstance().fightModel||(1==n.default.getInstance().fightModel?this.challengeType:2==n.default.getInstance().fightModel&&(this.currentFbProgressArr[n.default.getInstance().minjiangFuBenId-1]=1,i.default.getInstance().saveDataToLocal(2),this.updateTaskProgress(4)))},t.prototype.failedGame=function(){var e=this.popPanel.getChildByName("overPanel");e.active=!0,e.getChildByName("winPanel").active=!1,e.getChildByName("failedPanel").active=!0,this.isWin=!1},t.prototype.overPanelClick=function(){n.default.getInstance().isResetOver=!0;var e=this.popPanel.getChildByName("overPanel");this.isWin&&e.getChildByName("winPanel").getChildByName("lightCircle").getComponent(cc.Animation).stop(),e.active=!1,n.default.getInstance().skipBtnClick()},t.prototype.dailyTranscriptBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":120}');this.popPanel.getChildByName("dailyTranscriptPanel").active=!0},t.prototype.challengeTranscriptBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":119}');this.popPanel.getChildByName("challengeTranscriptPanel").active=!0,this.initFuBenProgress()},t.prototype.otherFubenBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":121}');this.commonTipsPop("80\u7ea7\u5f00\u542f")},t.prototype.initFuBenProgress=function(){for(var e=this.popPanel.getChildByName("challengeTranscriptPanel"),t=0;t<i.default.getInstance().levelNameArr.length;t++)if(void 0==this.currentFbProgressArr[t]&&(this.currentFbProgressArr[t]=0),0==this.currentFbProgressArr[t]){var a;switch(Math.floor(t/3)){case 0:a=0;break;case 1:a=2;break;case 2:a=3;break;case 3:a=7}return n.default.getInstance().minjiangFuBenId=t+1,e.getChildByName("img").getComponent(cc.Sprite).spriteFrame=n.default.getInstance().bossImgArr[a],void(e.getChildByName("levelName").getComponent(cc.Label).string=i.default.getInstance().levelNameArr[t])}},t.prototype.minjiangChallengeBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":131}');n.default.getInstance().isResetOver&&(n.default.getInstance().fightModel=2,this.popPanel.getChildByName("challengeTranscriptPanel").active=!1,n.default.getInstance().enterFightingScene())},t.prototype.chooseChallengeType=function(e){var t=e.target.name,a=t.substr(t.length-1,1),n=parseInt(a)-1;this.challengeType=n,this.updatePageView()},t.prototype.updatePageView=function(){for(var e=this.popPanel.getChildByName("dailyTranscriptPanel").getChildByName("pageView").children[1].children[0],t=0;t<e.childrenCount;t++)e.children[t].getChildByName("bg_equip").children[0].getComponent(cc.Sprite).spriteFrame=this.fubenImgArr[this.challengeType]},t.prototype.pageViewClick=function(e,t){var a=e.node;n.default.getInstance().transcriptLevelId=a.getComponent(cc.PageView).getCurrentPageIndex()+1},t.prototype.fubenBtnClick=function(e){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":130}');if(n.default.getInstance().isResetOver){var t=e.target.name.substring(4),a=parseInt(t);n.default.getInstance().transcriptLevelId=a,n.default.getInstance().fightModel=1,this.popPanel.getChildByName("dailyTranscriptPanel").active=!1,n.default.getInstance().enterFightingScene()}},t.prototype.dailyChallengeBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":130}');n.default.getInstance().isResetOver&&(n.default.getInstance().fightModel=1,this.popPanel.getChildByName("dailyTranscriptPanel").active=!1,n.default.getInstance().enterFightingScene())},t.prototype.updateTaskMenu=function(){var e=this.topPanel.getChildByName("taskMenu"),t=cc.color(255,0,0),a=cc.color(12,255,0);this.currentTask.progress>=this.currentTask.need_num?(e.getChildByName("taskProgress").color=a,this.currentTask.progress=this.currentTask.need_num,this.currentTask.state=1,this.topPanel.getChildByName("taskFinish").active=!0):(e.getChildByName("taskProgress").color=t,this.topPanel.getChildByName("taskFinish").active=!1),e.getChildByName("taskProgress").getComponent(cc.Label).string="("+this.currentTask.progress+"/"+this.currentTask.need_num+")",e.getChildByName("taskName").getComponent(cc.Label).string=this.currentTask.task_name,e.getChildByName("taskAward").getComponent(cc.Label).string="+"+this.currentTaskAward,i.default.getInstance().saveDataToLocal(2)},t.prototype.toTaskBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":109}');var e=this.currentTask.task_type,t=this.menuBtnParent.getChildByName("btn_squad"),a=this.menuBtnParent.getChildByName("btn_forge"),n=this.menuBtnParent.getChildByName("btn_recruiting");switch(e){case 0:this.commonTipsPop("\u6b63\u5728\u51fb\u9000\u654c\u519b");break;case 1:this.displayPanel(this.rolePanel,t),this.defaultPlayerDisPlay();break;case 2:this.displayPanel(this.forgePanel,a),this.defaultPlayerDisPlay();break;case 3:this.displayPanel(this.recruitingPanel,n);break;case 4:this.challengeTranscriptBtnClick();break;case 5:this.displayPanel(this.rolePanel,t),this.defaultPlayerDisPlay()}},t.prototype.updateTaskProgress=function(e){e==this.currentTask.task_type&&(this.currentTask.progress+=1,this.updateTaskMenu())},t.prototype.taskFinishBtnCLick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":110}');this.topPanel.getChildByName("finishEffect").getComponent(cc.Animation).play(),this.currentTaskId+=1,this.initMap(),this.currentTaskId>=34&&(this.currentTaskId=34),this.currentTask=i.default.getInstance().taskArr[this.currentTaskId],this.taskProgressArr[this.currentTask.task_type]=0,i.default.getInstance().saveDataToLocal(2);var e=200+Math.floor(20*Math.random());this.currentTaskAward=e,this.updateTaskMenu(),n.default.getInstance().getItemTips("\u7ecf\u9a8c",this.currentTaskAward),this.addExp(this.currentTaskAward)},t.prototype.petBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":107}');this.popPanel.getChildByName("petPanel").active=!0},t.prototype.mountBtnClick=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":108}');this.commonTipsPop("80\u7ea7\u5f00\u542f")},t.prototype.choosePetType=function(e){var t=e.target.name,a=t.substr(t.length-1,1),n=parseInt(a)-1;this.popPanel.getChildByName("petPanel").getChildByName("img").getComponent(cc.Sprite).spriteFrame=this.petImgArr[n]},t.prototype.commonTipsPop=function(e){var t=this.node.getChildByName("tipsParent").getChildByName("commonTips");t.children[0].getComponent(cc.Label).string=e,t.getComponent(cc.Animation).play()},t.instance=null,__decorate([c(cc.Node)],t.prototype,"menuBtnParent",void 0),__decorate([c(cc.Node)],t.prototype,"player",void 0),__decorate([c(cc.Node)],t.prototype,"rolePanel",void 0),__decorate([c(cc.Node)],t.prototype,"forgePanel",void 0),__decorate([c(cc.Node)],t.prototype,"townPanel",void 0),__decorate([c(cc.Node)],t.prototype,"backpackPanel",void 0),__decorate([c(cc.Node)],t.prototype,"recruitingPanel",void 0),__decorate([c(cc.Node)],t.prototype,"equipmentGrid",void 0),__decorate([c(cc.Node)],t.prototype,"itemGrid",void 0),__decorate([c(cc.Node)],t.prototype,"map",void 0),__decorate([c(cc.Node)],t.prototype,"bossBgMap",void 0),__decorate([c(cc.Prefab)],t.prototype,"itemTipsPrefab",void 0),__decorate([c(cc.Prefab)],t.prototype,"recycleEffectPrefab",void 0),__decorate([c(cc.Prefab)],t.prototype,"flyItemPrefabArray",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"heroIconArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"heroImgArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"forceImgArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"atkTypeImgArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"equipImgArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"fubenImgArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"mapArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"bossBgArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"petImgArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"playerIconArr",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"playerImgArr",void 0),__decorate([c(cc.Prefab)],t.prototype,"playerPrefabArray",void 0),t=a=__decorate([s],t)}(cc.Component);a.default=l,cc._RF.pop()},{"./DataManager":"DataManager","./GameManager":"GameManager","./MonsterManager":"MonsterManager"}],startGame:[function(e,t,a){"use strict";cc._RF.push(t,"effb7z9ev1D6Y3vY95oQfRr","startGame"),Object.defineProperty(a,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playerSpriteFrameArray=[],t.chooseSexNode=null,t.choosePlayerPanel=null,t.createBtn=null,t.btn_startGame=null,t.chooseNameNode=null,t.homePage=null,t.storyPanel=null,t.autoInGameTime=60,t.currentStoryLabel=null,t.currenStoryId=0,t.isStart=!1,t.isNamed=!1,t.textIndex=0,t.sexType=0,t.textArr=["\u6218\u6597\u573a\u666f\u52a0\u8f7d\u4e2d...","\u5f20\u98de\u6b63\u5728\u64e6\u62ed\u4ed6\u7684\u4e08\u516b\u86c7\u77db...","\u66f9\u64cd\u6b63\u5728\u96c6\u7ed3\u58eb\u5175...","\u5415\u5e03\u5df2\u7ecf\u52bf\u4e0d\u53ef\u6321...","\u5b59\u6743\u6b63\u5728\u53ec\u5f00\u5168\u4f53\u4f1a\u8bae..."],t}return __extends(t,e),t.prototype.onLoad=function(){this.initGame(),this.btn_startGame=this.node.getChildByName("btn_startGame"),this.choosePlayerPanel=cc.find("Canvas/choosePlayerPanel"),this.chooseSexNode=this.choosePlayerPanel.getChildByName("chooseSex"),this.chooseNameNode=this.choosePlayerPanel.getChildByName("chooseName"),this.createBtn=this.choosePlayerPanel.getChildByName("createBtn"),cc.director.preloadScene("mainGame")},t.prototype.initGame=function(){var e=this;cc.loader.loadRes("config",function(t,a){if(t)console.log("startGame\u52a0\u8f7djson\u6587\u4ef6\u51fa\u9519");else{var n=JSON.parse(cc.sys.localStorage.getItem("config"));e.isNamed=null==n?a.json.isNamed:n.json.isNamed,e.btn_startGame.on(cc.Node.EventType.TOUCH_END,function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":1}');e.isNamed?e.enterMainGame():e.firstEnterGame()},this)}})},t.prototype.firstEnterGame=function(){this.choosePlayProperty(),this.isStart=!0,this.createBtn.on(cc.Node.EventType.TOUCH_END,this.enterMainGame,this),this.chooseNameNode.getChildByName("lab_name").getComponent(cc.Label).string=this.node.getComponent("RandomName").initName(),this.choosePlayerPanel.active=!0},t.prototype.enterMainGame=function(){if(cc.sys.isNative)jsb.reflection.callStaticMethod("CC3drthNativeRoad","cc_cocosCallNativeWithName:params:","eventRecord",'{"event":2}');var e=this;null!=JSON.parse(cc.sys.localStorage.getItem("config"))?(cc.director.loadScene("mainGame"),e.loadProgress()):cc.loader.loadRes("config",function(t,a){t?console.log("startGame\u52a0\u8f7djson\u6587\u4ef6\u51fa\u9519"):(a.json.isNamed=!0,a.json.sexType=e.sexType,a.json.playerProperty.name=e.chooseNameNode.getChildByName("lab_name").getComponent(cc.Label).string,cc.sys.localStorage.setItem("config",JSON.stringify(a)),e.loadProgress())})},t.prototype.choosePlayProperty=function(){var e=this;this.chooseSexNode.getChildByName("btn_boy").on(cc.Node.EventType.TOUCH_END,function(){e.choosePlayerPanel.getChildByName("playerSprite").getComponent(cc.Sprite).spriteFrame=e.playerSpriteFrameArray[0],e.sexType=0},this),this.chooseSexNode.getChildByName("btn_girl").on(cc.Node.EventType.TOUCH_END,function(){e.choosePlayerPanel.getChildByName("playerSprite").getComponent(cc.Sprite).spriteFrame=e.playerSpriteFrameArray[1],e.sexType=1},this),this.chooseNameNode.getChildByName("btn_nextName").on(cc.Node.EventType.TOUCH_END,function(){e.chooseNameNode.getChildByName("lab_name").getComponent(cc.Label).string=e.node.getComponent("RandomName").initName()},this)},t.prototype.loadProgress=function(){var e=this,t=cc.find("Canvas/loadingPanel");t.active=!0,this.schedule(function(){t.getChildByName("text").getComponent(cc.Label).string=e.textArr[e.textIndex],e.textIndex+=1,e.textIndex>=e.textArr.length&&(e.textIndex=0)},.5,cc.macro.REPEAT_FOREVER,0),t.getChildByName("loadingImg").getComponent(cc.Animation).play(),cc.director.loadScene("mainGame")},t.prototype.update=function(e){this.isStart&&(this.autoInGameTime-=e,this.chooseNameNode.getChildByName("timeLabel").getComponent(cc.Label).string=Math.floor(this.autoInGameTime)+"s",this.autoInGameTime<=0&&this.enterMainGame())},__decorate([i(cc.SpriteFrame)],t.prototype,"playerSpriteFrameArray",void 0),t=__decorate([r],t)}(cc.Component);a.default=o,cc._RF.pop()},{}]},{},["Camera","CollisderManager","DataManager","GameManager","Hero","MapScroll","Monster","MonsterManager","Player","PlayerAi","RandomName","TaskList","UiManager","startGame","ShaderComponent","ShaderLab","ShaderManager","ShaderMaterial"]);